<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Probability in R (with Lucy King) | An R companion to Statistical Thinking for the 21st Century</title>
  <meta name="description" content="A book about doing statistics using R." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Probability in R (with Lucy King) | An R companion to Statistical Thinking for the 21st Century" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A book about doing statistics using R." />
  <meta name="github-repo" content="statsthinking21/statsthinking21-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Probability in R (with Lucy King) | An R companion to Statistical Thinking for the 21st Century" />
  
  <meta name="twitter:description" content="A book about doing statistics using R." />
  

<meta name="author" content="Copyright 2020 Russell A. Poldrack" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fitting-simple-models-using-r.html"/>
<link rel="next" href="sampling-in-r.html"/>
<script src="book_assets/jquery-3.6.1/jquery-3.6.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129414074-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129414074-1');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i><b>0.1</b> Why R?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#the-golden-age-of-data"><i class="fa fa-check"></i><b>0.2</b> The golden age of data</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#an-open-source-book"><i class="fa fa-check"></i><b>0.3</b> An open source book</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>0.4</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#why-programming-is-hard-to-learn"><i class="fa fa-check"></i><b>1.1</b> Why programming is hard to learn</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#use-the-web"><i class="fa fa-check"></i><b>1.1.1</b> Use the web</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rubber-duck-debugging"><i class="fa fa-check"></i><b>1.1.2</b> Rubber duck debugging</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-rstudio"><i class="fa fa-check"></i><b>1.2</b> Using RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-started-with-r"><i class="fa fa-check"></i><b>1.3</b> Getting started with R</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>1.4</b> Variables</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>1.5</b> Functions</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>1.6</b> Vectors</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#math-with-vectors"><i class="fa fa-check"></i><b>1.7</b> Math with vectors</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frames"><i class="fa fa-check"></i><b>1.8</b> Data Frames</a></li>
<li class="chapter" data-level="1.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-r-libraries"><i class="fa fa-check"></i><b>1.9</b> Using R libraries</a></li>
<li class="chapter" data-level="1.10" data-path="introduction-to-r.html"><a href="introduction-to-r.html#working-with-data-files"><i class="fa fa-check"></i><b>1.10</b> Working with data files</a></li>
<li class="chapter" data-level="1.11" data-path="introduction-to-r.html"><a href="introduction-to-r.html#learning-objectives"><i class="fa fa-check"></i><b>1.11</b> Learning objectives</a></li>
<li class="chapter" data-level="1.12" data-path="introduction-to-r.html"><a href="introduction-to-r.html#suggested-readings-and-videos"><i class="fa fa-check"></i><b>1.12</b> Suggested readings and videos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>2</b> Summarizing data using R (with Lucy King)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#introduction-to-the-tidyverse"><i class="fa fa-check"></i><b>2.1</b> Introduction to the Tidyverse</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarizing-data.html"><a href="summarizing-data.html#making-a-data-frame-using-tibble"><i class="fa fa-check"></i><b>2.1.1</b> Making a data frame using tibble()</a></li>
<li class="chapter" data-level="2.1.2" data-path="summarizing-data.html"><a href="summarizing-data.html#selecting-an-element"><i class="fa fa-check"></i><b>2.1.2</b> Selecting an element</a></li>
<li class="chapter" data-level="2.1.3" data-path="summarizing-data.html"><a href="summarizing-data.html#adding-a-row-or-column"><i class="fa fa-check"></i><b>2.1.3</b> Adding a row or column</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarizing-data.html"><a href="summarizing-data.html#creating-or-modifying-variables-using-mutate"><i class="fa fa-check"></i><b>2.2</b> Creating or modifying variables using <code>mutate()</code></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#remove-a-column-using-the-select-function"><i class="fa fa-check"></i><b>2.2.1</b> Remove a column using the select() function</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarizing-data.html"><a href="summarizing-data.html#tidyverse-in-action"><i class="fa fa-check"></i><b>2.3</b> Tidyverse in action</a></li>
<li class="chapter" data-level="2.4" data-path="summarizing-data.html"><a href="summarizing-data.html#looking-at-individual-variables-using-pull-and-head"><i class="fa fa-check"></i><b>2.4</b> Looking at individual variables using pull() and head()</a></li>
<li class="chapter" data-level="2.5" data-path="summarizing-data.html"><a href="summarizing-data.html#frequency-distributions"><i class="fa fa-check"></i><b>2.5</b> Computing a frequency distribution (Section @ref(frequency-distributions))</a></li>
<li class="chapter" data-level="2.6" data-path="summarizing-data.html"><a href="summarizing-data.html#cumulative-distributions"><i class="fa fa-check"></i><b>2.6</b> Computing a cumulative distribution (Section @ref(cumulative-distributions))</a></li>
<li class="chapter" data-level="2.7" data-path="summarizing-data.html"><a href="summarizing-data.html#data-cleaning-and-tidying-with-r"><i class="fa fa-check"></i><b>2.7</b> Data cleaning and tidying with R</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="summarizing-data.html"><a href="summarizing-data.html#statistics-attitude-data-from-course-survey"><i class="fa fa-check"></i><b>2.7.1</b> Statistics attitude data from course survey</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>3</b> Data visualization using R (with Anna Khazenzon)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-visualization.html"><a href="data-visualization.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>3.1</b> The grammar of graphics</a></li>
<li class="chapter" data-level="3.2" data-path="data-visualization.html"><a href="data-visualization.html#getting-started"><i class="fa fa-check"></i><b>3.2</b> Getting started</a></li>
<li class="chapter" data-level="3.3" data-path="data-visualization.html"><a href="data-visualization.html#lets-think-through-a-visualization"><i class="fa fa-check"></i><b>3.3</b> Let’s think through a visualization</a></li>
<li class="chapter" data-level="3.4" data-path="data-visualization.html"><a href="data-visualization.html#plotting-the-distribution-of-a-single-variable"><i class="fa fa-check"></i><b>3.4</b> Plotting the distribution of a single variable</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-visualization.html"><a href="data-visualization.html#histogram"><i class="fa fa-check"></i><b>3.4.1</b> Histogram</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-visualization.html"><a href="data-visualization.html#density-plot"><i class="fa fa-check"></i><b>3.4.2</b> Density plot</a></li>
<li class="chapter" data-level="3.4.3" data-path="data-visualization.html"><a href="data-visualization.html#bar-vs.-line-plots"><i class="fa fa-check"></i><b>3.4.3</b> Bar vs. line plots</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-visualization.html"><a href="data-visualization.html#plots-with-two-variables"><i class="fa fa-check"></i><b>3.5</b> Plots with two variables</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-visualization.html"><a href="data-visualization.html#adding-on-variables"><i class="fa fa-check"></i><b>3.5.1</b> Adding on variables</a></li>
<li class="chapter" data-level="3.5.2" data-path="data-visualization.html"><a href="data-visualization.html#plotting-dispersion"><i class="fa fa-check"></i><b>3.5.2</b> Plotting dispersion</a></li>
<li class="chapter" data-level="3.5.3" data-path="data-visualization.html"><a href="data-visualization.html#scatter-plot"><i class="fa fa-check"></i><b>3.5.3</b> Scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-visualization.html"><a href="data-visualization.html#creating-a-more-complex-plot"><i class="fa fa-check"></i><b>3.6</b> Creating a more complex plot</a></li>
<li class="chapter" data-level="3.7" data-path="data-visualization.html"><a href="data-visualization.html#additional-reading-and-resources"><i class="fa fa-check"></i><b>3.7</b> Additional reading and resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html"><i class="fa fa-check"></i><b>4</b> Fitting simple models using R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#mean"><i class="fa fa-check"></i><b>4.1</b> Mean</a></li>
<li class="chapter" data-level="4.2" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#median"><i class="fa fa-check"></i><b>4.2</b> Median</a></li>
<li class="chapter" data-level="4.3" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#mode"><i class="fa fa-check"></i><b>4.3</b> Mode</a></li>
<li class="chapter" data-level="4.4" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#variability"><i class="fa fa-check"></i><b>4.4</b> Variability</a></li>
<li class="chapter" data-level="4.5" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#z-scores"><i class="fa fa-check"></i><b>4.5</b> Z-scores</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html"><i class="fa fa-check"></i><b>5</b> Probability in R (with Lucy King)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html#basic-probability-calculations"><i class="fa fa-check"></i><b>5.1</b> Basic probability calculations</a></li>
<li class="chapter" data-level="5.2" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html#empirical-frequency"><i class="fa fa-check"></i><b>5.2</b> Empirical frequency (Section @ref(empirical-frequency))</a></li>
<li class="chapter" data-level="5.3" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html#conditional-probability"><i class="fa fa-check"></i><b>5.3</b> Conditional probability (Section @ref(conditional-probability))</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sampling-in-r.html"><a href="sampling-in-r.html"><i class="fa fa-check"></i><b>6</b> Sampling in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#samplingerror"><i class="fa fa-check"></i><b>6.1</b> Sampling error (Section @ref(samplingerror))</a></li>
<li class="chapter" data-level="6.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#central-limit-theorem"><i class="fa fa-check"></i><b>6.2</b> Central limit theorem</a></li>
<li class="chapter" data-level="6.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#confidence-intervals"><i class="fa fa-check"></i><b>6.3</b> Confidence intervals (Section @ref(confidence-intervals))</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html"><i class="fa fa-check"></i><b>7</b> Resampling and simulation in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html#generating-random-numbers"><i class="fa fa-check"></i><b>7.1</b> Generating random samples (Section @ref(generating-random-numbers))</a></li>
<li class="chapter" data-level="7.2" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html#simulating-the-maximum-finishing-time"><i class="fa fa-check"></i><b>7.2</b> Simulating the maximum finishing time</a></li>
<li class="chapter" data-level="7.3" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html#the-bootstrap"><i class="fa fa-check"></i><b>7.3</b> The bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="hypothesis-testing-in-r.html"><a href="hypothesis-testing-in-r.html"><i class="fa fa-check"></i><b>8</b> Hypothesis testing in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="hypothesis-testing-in-r.html"><a href="hypothesis-testing-in-r.html#randomization-very-simple"><i class="fa fa-check"></i><b>8.1</b> Simple example: Coin-flipping (Section @ref(randomization-very-simple))</a></li>
<li class="chapter" data-level="8.2" data-path="hypothesis-testing-in-r.html"><a href="hypothesis-testing-in-r.html#simulating-p-values"><i class="fa fa-check"></i><b>8.2</b> Simulating p-values</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html"><i class="fa fa-check"></i><b>9</b> Statistical power in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#computing-confidence-intervals"><i class="fa fa-check"></i><b>9.1</b> Computing confidence intervals</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#theoretical"><i class="fa fa-check"></i><b>9.1.1</b> Theoretical</a></li>
<li class="chapter" data-level="9.1.2" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#bootstrap"><i class="fa fa-check"></i><b>9.1.2</b> Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#effect-size"><i class="fa fa-check"></i><b>9.2</b> Effect Size</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#cohens-d"><i class="fa fa-check"></i><b>9.2.1</b> Cohen’s d</a></li>
<li class="chapter" data-level="9.2.2" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#pearsons-r"><i class="fa fa-check"></i><b>9.2.2</b> Pearson’s r</a></li>
<li class="chapter" data-level="9.2.3" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#odds-ratio"><i class="fa fa-check"></i><b>9.2.3</b> Odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#power-analysis"><i class="fa fa-check"></i><b>9.3</b> Power analysis</a></li>
<li class="chapter" data-level="9.4" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#power-curves"><i class="fa fa-check"></i><b>9.4</b> Power curves</a></li>
<li class="chapter" data-level="9.5" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#simulating-statistical-power"><i class="fa fa-check"></i><b>9.5</b> Simulating statistical power</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html"><i class="fa fa-check"></i><b>10</b> Bayesian statistics in R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html#doing-bayesian-estimation"><i class="fa fa-check"></i><b>10.1</b> A simple example (Section @ref(doing-bayesian-estimation))</a></li>
<li class="chapter" data-level="10.2" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html#estimating-posterior-distributions"><i class="fa fa-check"></i><b>10.2</b> Estimating posterior distributions (Section @ref(estimating-posterior-distributions))</a></li>
<li class="chapter" data-level="10.3" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html#Bayes-factors"><i class="fa fa-check"></i><b>10.3</b> Bayes factors (Section @ref(Bayes-factors))</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modeling-categorical-relationships-in-r.html"><a href="modeling-categorical-relationships-in-r.html"><i class="fa fa-check"></i><b>11</b> Modeling categorical relationships in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="modeling-categorical-relationships-in-r.html"><a href="modeling-categorical-relationships-in-r.html#chi-squared-test"><i class="fa fa-check"></i><b>11.1</b> The Pearson Chi-squared test (Section @ref(chi-squared-test))</a></li>
<li class="chapter" data-level="11.2" data-path="modeling-categorical-relationships-in-r.html"><a href="modeling-categorical-relationships-in-r.html#two-way-test"><i class="fa fa-check"></i><b>11.2</b> Two-way tests (Section @ref(two-way-test})</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html"><i class="fa fa-check"></i><b>12</b> Modeling continuous relationships in R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html#covariance-and-correlation"><i class="fa fa-check"></i><b>12.1</b> Computing covariance and correlation (Section @ref(covariance-and-correlation))</a></li>
<li class="chapter" data-level="12.2" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html#hate-crime-example"><i class="fa fa-check"></i><b>12.2</b> Hate crime example</a></li>
<li class="chapter" data-level="12.3" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html#robust-correlations"><i class="fa fa-check"></i><b>12.3</b> Robust correlations (Section @ref(robust-correlations))</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html"><i class="fa fa-check"></i><b>13</b> The General Linear Model in R</a>
<ul>
<li class="chapter" data-level="13.1" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#linear-regression"><i class="fa fa-check"></i><b>13.1</b> Linear regression (Section @ref(linear-regression))</a></li>
<li class="chapter" data-level="13.2" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#model-criticism"><i class="fa fa-check"></i><b>13.2</b> Model criticism and diagnostics (Section @ref(model-criticism))</a></li>
<li class="chapter" data-level="13.3" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#examples-of-problematic-model-fit"><i class="fa fa-check"></i><b>13.3</b> Examples of problematic model fit</a></li>
<li class="chapter" data-level="13.4" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#extending-regression-to-binary-outcomes."><i class="fa fa-check"></i><b>13.4</b> Extending regression to binary outcomes.</a></li>
<li class="chapter" data-level="13.5" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#cross-validation"><i class="fa fa-check"></i><b>13.5</b> Cross-validation (Section @ref(cross-validation))</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html"><i class="fa fa-check"></i><b>14</b> Comparing means in R</a>
<ul>
<li class="chapter" data-level="14.1" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#single-mean"><i class="fa fa-check"></i><b>14.1</b> Testing the value of a single mean (Section @ref(single-mean))</a></li>
<li class="chapter" data-level="14.2" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#comparing-two-means"><i class="fa fa-check"></i><b>14.2</b> Comparing two means (Section @ref(comparing-two-means))</a></li>
<li class="chapter" data-level="14.3" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#ttest-linear-model"><i class="fa fa-check"></i><b>14.3</b> The t-test as a linear model (Section @ref(ttest-linear-model))</a></li>
<li class="chapter" data-level="14.4" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#paired-ttests"><i class="fa fa-check"></i><b>14.4</b> Comparing paired observations (Section @ref(paired-ttests))</a></li>
<li class="chapter" data-level="14.5" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#ANOVA"><i class="fa fa-check"></i><b>14.5</b> Analysis of variance (Section @ref(ANOVA))</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#repeated-measures-analysis-of-variance"><i class="fa fa-check"></i><b>14.5.1</b> Repeated measures analysis of variance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="practical-statistical-modeling-in-r.html"><a href="practical-statistical-modeling-in-r.html"><i class="fa fa-check"></i><b>15</b> Practical statistical modeling in R</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An R companion to Statistical Thinking for the 21st Century</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probability-in-r-with-lucy-king" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Probability in R (with Lucy King)<a href="probability-in-r-with-lucy-king.html#probability-in-r-with-lucy-king" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter we will go over probability computations in R.</p>
<div id="basic-probability-calculations" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Basic probability calculations<a href="probability-in-r-with-lucy-king.html#basic-probability-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s create a vector of outcomes from one to 6, using the <code>seq()</code> function to create such a sequence:</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="probability-in-r-with-lucy-king.html#cb183-1" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">6</span>)</span>
<span id="cb183-2"><a href="probability-in-r-with-lucy-king.html#cb183-2" tabindex="-1"></a>outcomes</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5 6</code></pre>
<p>Now let’s create a vector of logical values based on whether the outcome in each position is equal to 1. Remember that <code>==</code> tests for equality of each element in a vector:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="probability-in-r-with-lucy-king.html#cb185-1" tabindex="-1"></a>outcome1isTrue <span class="ot">&lt;-</span> outcomes <span class="sc">==</span> <span class="dv">1</span> </span>
<span id="cb185-2"><a href="probability-in-r-with-lucy-king.html#cb185-2" tabindex="-1"></a>outcome1isTrue</span></code></pre></div>
<pre><code>## [1]  TRUE FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>Remember that the simple probability of an outcome is number of occurrences of the outcome divided by the total number of events. To compute a probability, we can take advantage of the fact that TRUE/FALSE are equivalent to 1/0 in R. The formula for the mean (sum of values divided by the number of values) is thus exactly the same as the formula for the simple probability! So, we can compute the probability of the event by simply taking the mean of the logical vector.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="probability-in-r-with-lucy-king.html#cb187-1" tabindex="-1"></a>p1isTrue <span class="ot">&lt;-</span> <span class="fu">mean</span>(outcome1isTrue)</span>
<span id="cb187-2"><a href="probability-in-r-with-lucy-king.html#cb187-2" tabindex="-1"></a>p1isTrue</span></code></pre></div>
<pre><code>## [1] 0.1666667</code></pre>
</div>
<div id="empirical-frequency" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Empirical frequency (Section <a href="probability-in-r-with-lucy-king.html#empirical-frequency">5.2</a>)<a href="probability-in-r-with-lucy-king.html#empirical-frequency" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s walk through how we computed empirical frequency of rain in San Francisco.</p>
<p>First we load the data:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="probability-in-r-with-lucy-king.html#cb189-1" tabindex="-1"></a><span class="co"># we will remove the STATION and NAME variables </span></span>
<span id="cb189-2"><a href="probability-in-r-with-lucy-king.html#cb189-2" tabindex="-1"></a><span class="co"># since they are identical for all rows</span></span>
<span id="cb189-3"><a href="probability-in-r-with-lucy-king.html#cb189-3" tabindex="-1"></a>SFrain <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/SanFranciscoRain/1329219.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb189-4"><a href="probability-in-r-with-lucy-king.html#cb189-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>STATION, <span class="sc">-</span>NAME)</span>
<span id="cb189-5"><a href="probability-in-r-with-lucy-king.html#cb189-5" tabindex="-1"></a>  </span>
<span id="cb189-6"><a href="probability-in-r-with-lucy-king.html#cb189-6" tabindex="-1"></a><span class="fu">glimpse</span>(SFrain)</span></code></pre></div>
<pre><code>## Rows: 365
## Columns: 2
## $ DATE &lt;date&gt; 2017-01-01, 2017-01-02, 2017-01-03, 2017-01-…
## $ PRCP &lt;dbl&gt; 0.05, 0.10, 0.40, 0.89, 0.01, 0.00, 0.82, 1.4…</code></pre>
<p>We see that the data frame contains a variable called <code>PRCP</code> which denotes the amount of rain each day. Let’s create a new variable called <code>rainToday</code> that denotes whether the amount of precipitation was above zero:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="probability-in-r-with-lucy-king.html#cb191-1" tabindex="-1"></a>SFrain <span class="ot">&lt;-</span> </span>
<span id="cb191-2"><a href="probability-in-r-with-lucy-king.html#cb191-2" tabindex="-1"></a>  SFrain <span class="sc">%&gt;%</span></span>
<span id="cb191-3"><a href="probability-in-r-with-lucy-king.html#cb191-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rainToday =</span> <span class="fu">as.integer</span>(PRCP <span class="sc">&gt;</span> <span class="dv">0</span>))</span>
<span id="cb191-4"><a href="probability-in-r-with-lucy-king.html#cb191-4" tabindex="-1"></a></span>
<span id="cb191-5"><a href="probability-in-r-with-lucy-king.html#cb191-5" tabindex="-1"></a><span class="fu">glimpse</span>(SFrain)</span></code></pre></div>
<pre><code>## Rows: 365
## Columns: 3
## $ DATE      &lt;date&gt; 2017-01-01, 2017-01-02, 2017-01-03, 201…
## $ PRCP      &lt;dbl&gt; 0.05, 0.10, 0.40, 0.89, 0.01, 0.00, 0.82…
## $ rainToday &lt;int&gt; 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0…</code></pre>
<p>Now we will summarize the data to compute the probability of rain:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="probability-in-r-with-lucy-king.html#cb193-1" tabindex="-1"></a>pRainInSF <span class="ot">&lt;-</span> </span>
<span id="cb193-2"><a href="probability-in-r-with-lucy-king.html#cb193-2" tabindex="-1"></a>  SFrain <span class="sc">%&gt;%</span></span>
<span id="cb193-3"><a href="probability-in-r-with-lucy-king.html#cb193-3" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb193-4"><a href="probability-in-r-with-lucy-king.html#cb193-4" tabindex="-1"></a>    <span class="at">pRainInSF =</span> <span class="fu">mean</span>(rainToday)</span>
<span id="cb193-5"><a href="probability-in-r-with-lucy-king.html#cb193-5" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb193-6"><a href="probability-in-r-with-lucy-king.html#cb193-6" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb193-7"><a href="probability-in-r-with-lucy-king.html#cb193-7" tabindex="-1"></a></span>
<span id="cb193-8"><a href="probability-in-r-with-lucy-king.html#cb193-8" tabindex="-1"></a>pRainInSF</span></code></pre></div>
<pre><code>## [1] 0.2</code></pre>
</div>
<div id="conditional-probability" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Conditional probability (Section <a href="probability-in-r-with-lucy-king.html#conditional-probability">5.3</a>)<a href="probability-in-r-with-lucy-king.html#conditional-probability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s determine the conditional probability of someone being unhealthy, given that they are over 70 years of age, using the NHANES dataset. Let’s create a new data frame that only contains people over 70 years old.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="probability-in-r-with-lucy-king.html#cb195-1" tabindex="-1"></a>healthDataFrame <span class="ot">&lt;-</span></span>
<span id="cb195-2"><a href="probability-in-r-with-lucy-king.html#cb195-2" tabindex="-1"></a>  NHANES <span class="sc">%&gt;%</span></span>
<span id="cb195-3"><a href="probability-in-r-with-lucy-king.html#cb195-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb195-4"><a href="probability-in-r-with-lucy-king.html#cb195-4" tabindex="-1"></a>    <span class="at">Over70 =</span> Age <span class="sc">&gt;</span> <span class="dv">70</span>,</span>
<span id="cb195-5"><a href="probability-in-r-with-lucy-king.html#cb195-5" tabindex="-1"></a>    <span class="at">Unhealthy =</span> DaysPhysHlthBad <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb195-6"><a href="probability-in-r-with-lucy-king.html#cb195-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb195-7"><a href="probability-in-r-with-lucy-king.html#cb195-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Unhealthy, Over70) <span class="sc">%&gt;%</span></span>
<span id="cb195-8"><a href="probability-in-r-with-lucy-king.html#cb195-8" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb195-9"><a href="probability-in-r-with-lucy-king.html#cb195-9" tabindex="-1"></a></span>
<span id="cb195-10"><a href="probability-in-r-with-lucy-king.html#cb195-10" tabindex="-1"></a><span class="fu">glimpse</span>(healthDataFrame)</span></code></pre></div>
<pre><code>## Rows: 4,891
## Columns: 2
## $ Unhealthy &lt;lgl&gt; FALSE, FALSE, FALSE, TRUE, FALSE, TRUE, …
## $ Over70    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE…</code></pre>
<p>First, what’s the probability of being over 70?</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="probability-in-r-with-lucy-king.html#cb197-1" tabindex="-1"></a>pOver70 <span class="ot">&lt;-</span> </span>
<span id="cb197-2"><a href="probability-in-r-with-lucy-king.html#cb197-2" tabindex="-1"></a>  healthDataFrame <span class="sc">%&gt;%</span></span>
<span id="cb197-3"><a href="probability-in-r-with-lucy-king.html#cb197-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pOver70 =</span> <span class="fu">mean</span>(Over70)) <span class="sc">%&gt;%</span> </span>
<span id="cb197-4"><a href="probability-in-r-with-lucy-king.html#cb197-4" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb197-5"><a href="probability-in-r-with-lucy-king.html#cb197-5" tabindex="-1"></a></span>
<span id="cb197-6"><a href="probability-in-r-with-lucy-king.html#cb197-6" tabindex="-1"></a><span class="co"># to obtain the specific value, we need to extract it from the data frame</span></span>
<span id="cb197-7"><a href="probability-in-r-with-lucy-king.html#cb197-7" tabindex="-1"></a></span>
<span id="cb197-8"><a href="probability-in-r-with-lucy-king.html#cb197-8" tabindex="-1"></a>pOver70</span></code></pre></div>
<pre><code>## [1] 0.1106113</code></pre>
<p>Second, what’s the probability of being unhealthy?</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="probability-in-r-with-lucy-king.html#cb199-1" tabindex="-1"></a>pUnhealthy <span class="ot">&lt;-</span> </span>
<span id="cb199-2"><a href="probability-in-r-with-lucy-king.html#cb199-2" tabindex="-1"></a>  healthDataFrame <span class="sc">%&gt;%</span></span>
<span id="cb199-3"><a href="probability-in-r-with-lucy-king.html#cb199-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pUnhealthy =</span> <span class="fu">mean</span>(Unhealthy)) <span class="sc">%&gt;%</span> </span>
<span id="cb199-4"><a href="probability-in-r-with-lucy-king.html#cb199-4" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb199-5"><a href="probability-in-r-with-lucy-king.html#cb199-5" tabindex="-1"></a></span>
<span id="cb199-6"><a href="probability-in-r-with-lucy-king.html#cb199-6" tabindex="-1"></a>pUnhealthy</span></code></pre></div>
<pre><code>## [1] 0.3567778</code></pre>
<p>What’s the probability for each combination of unhealthy/healthy and over 70/ not? We can create a new variable that finds the joint probability by multiplying the two individual binary variables together; since anything times zero is zero, this will only have the value 1 for any case where both are true.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="probability-in-r-with-lucy-king.html#cb201-1" tabindex="-1"></a>pBoth <span class="ot">&lt;-</span> healthDataFrame <span class="sc">%&gt;%</span> </span>
<span id="cb201-2"><a href="probability-in-r-with-lucy-king.html#cb201-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb201-3"><a href="probability-in-r-with-lucy-king.html#cb201-3" tabindex="-1"></a>    <span class="at">both =</span> Unhealthy<span class="sc">*</span>Over70</span>
<span id="cb201-4"><a href="probability-in-r-with-lucy-king.html#cb201-4" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb201-5"><a href="probability-in-r-with-lucy-king.html#cb201-5" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb201-6"><a href="probability-in-r-with-lucy-king.html#cb201-6" tabindex="-1"></a>    <span class="at">pBoth =</span> <span class="fu">mean</span>(both)) <span class="sc">%&gt;%</span> </span>
<span id="cb201-7"><a href="probability-in-r-with-lucy-king.html#cb201-7" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb201-8"><a href="probability-in-r-with-lucy-king.html#cb201-8" tabindex="-1"></a></span>
<span id="cb201-9"><a href="probability-in-r-with-lucy-king.html#cb201-9" tabindex="-1"></a>pBoth</span></code></pre></div>
<pre><code>## [1] 0.04252709</code></pre>
<p>Finally, what’s the probability of someone being unhealthy, given that they are over 70 years of age?</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="probability-in-r-with-lucy-king.html#cb203-1" tabindex="-1"></a>pUnhealthyGivenOver70 <span class="ot">&lt;-</span></span>
<span id="cb203-2"><a href="probability-in-r-with-lucy-king.html#cb203-2" tabindex="-1"></a>  healthDataFrame <span class="sc">%&gt;%</span></span>
<span id="cb203-3"><a href="probability-in-r-with-lucy-king.html#cb203-3" tabindex="-1"></a>  <span class="fu">filter</span>(Over70 <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co"># limit to Over70</span></span>
<span id="cb203-4"><a href="probability-in-r-with-lucy-king.html#cb203-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pUnhealthy =</span> <span class="fu">mean</span>(Unhealthy)) <span class="sc">%&gt;%</span> </span>
<span id="cb203-5"><a href="probability-in-r-with-lucy-king.html#cb203-5" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb203-6"><a href="probability-in-r-with-lucy-king.html#cb203-6" tabindex="-1"></a></span>
<span id="cb203-7"><a href="probability-in-r-with-lucy-king.html#cb203-7" tabindex="-1"></a>pUnhealthyGivenOver70</span></code></pre></div>
<pre><code>## [1] 0.3844732</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="probability-in-r-with-lucy-king.html#cb205-1" tabindex="-1"></a><span class="co"># compute the opposite:</span></span>
<span id="cb205-2"><a href="probability-in-r-with-lucy-king.html#cb205-2" tabindex="-1"></a><span class="co"># what the probability of being over 70 given that </span></span>
<span id="cb205-3"><a href="probability-in-r-with-lucy-king.html#cb205-3" tabindex="-1"></a><span class="co"># one is unhealthy?</span></span>
<span id="cb205-4"><a href="probability-in-r-with-lucy-king.html#cb205-4" tabindex="-1"></a>pOver70givenUnhealthy <span class="ot">&lt;-</span></span>
<span id="cb205-5"><a href="probability-in-r-with-lucy-king.html#cb205-5" tabindex="-1"></a>  healthDataFrame <span class="sc">%&gt;%</span></span>
<span id="cb205-6"><a href="probability-in-r-with-lucy-king.html#cb205-6" tabindex="-1"></a>  <span class="fu">filter</span>(Unhealthy <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co"># limit to Unhealthy</span></span>
<span id="cb205-7"><a href="probability-in-r-with-lucy-king.html#cb205-7" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">pOver70 =</span> <span class="fu">mean</span>(Over70)) <span class="sc">%&gt;%</span> </span>
<span id="cb205-8"><a href="probability-in-r-with-lucy-king.html#cb205-8" tabindex="-1"></a>  <span class="fu">pull</span>()</span>
<span id="cb205-9"><a href="probability-in-r-with-lucy-king.html#cb205-9" tabindex="-1"></a></span>
<span id="cb205-10"><a href="probability-in-r-with-lucy-king.html#cb205-10" tabindex="-1"></a>pOver70givenUnhealthy</span></code></pre></div>
<pre><code>## [1] 0.1191977</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fitting-simple-models-using-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sampling-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/statsthinking21/statsthinking21-R/edit/master/05-Probability.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["StatsThinking21.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
