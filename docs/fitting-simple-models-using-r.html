<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Fitting simple models using R | An R companion to Statistical Thinking for the 21st Century</title>
  <meta name="description" content="A book about doing statistics using R." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Fitting simple models using R | An R companion to Statistical Thinking for the 21st Century" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A book about doing statistics using R." />
  <meta name="github-repo" content="statsthinking21/statsthinking21-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Fitting simple models using R | An R companion to Statistical Thinking for the 21st Century" />
  
  <meta name="twitter:description" content="A book about doing statistics using R." />
  

<meta name="author" content="Copyright 2020 Russell A. Poldrack" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualization.html"/>
<link rel="next" href="probability-in-r-with-lucy-king.html"/>
<script src="book_assets/jquery-3.6.1/jquery-3.6.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="book_assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="book_assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="book_assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129414074-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129414074-1');
</script>



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i><b>0.1</b> Why R?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#the-golden-age-of-data"><i class="fa fa-check"></i><b>0.2</b> The golden age of data</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#an-open-source-book"><i class="fa fa-check"></i><b>0.3</b> An open source book</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>0.4</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#why-programming-is-hard-to-learn"><i class="fa fa-check"></i><b>1.1</b> Why programming is hard to learn</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#use-the-web"><i class="fa fa-check"></i><b>1.1.1</b> Use the web</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rubber-duck-debugging"><i class="fa fa-check"></i><b>1.1.2</b> Rubber duck debugging</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-rstudio"><i class="fa fa-check"></i><b>1.2</b> Using RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-started-with-r"><i class="fa fa-check"></i><b>1.3</b> Getting started with R</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>1.4</b> Variables</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>1.5</b> Functions</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>1.6</b> Vectors</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#math-with-vectors"><i class="fa fa-check"></i><b>1.7</b> Math with vectors</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frames"><i class="fa fa-check"></i><b>1.8</b> Data Frames</a></li>
<li class="chapter" data-level="1.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-r-libraries"><i class="fa fa-check"></i><b>1.9</b> Using R libraries</a></li>
<li class="chapter" data-level="1.10" data-path="introduction-to-r.html"><a href="introduction-to-r.html#working-with-data-files"><i class="fa fa-check"></i><b>1.10</b> Working with data files</a></li>
<li class="chapter" data-level="1.11" data-path="introduction-to-r.html"><a href="introduction-to-r.html#learning-objectives"><i class="fa fa-check"></i><b>1.11</b> Learning objectives</a></li>
<li class="chapter" data-level="1.12" data-path="introduction-to-r.html"><a href="introduction-to-r.html#suggested-readings-and-videos"><i class="fa fa-check"></i><b>1.12</b> Suggested readings and videos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>2</b> Summarizing data using R (with Lucy King)</a>
<ul>
<li class="chapter" data-level="2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#introduction-to-the-tidyverse"><i class="fa fa-check"></i><b>2.1</b> Introduction to the Tidyverse</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="summarizing-data.html"><a href="summarizing-data.html#making-a-data-frame-using-tibble"><i class="fa fa-check"></i><b>2.1.1</b> Making a data frame using tibble()</a></li>
<li class="chapter" data-level="2.1.2" data-path="summarizing-data.html"><a href="summarizing-data.html#selecting-an-element"><i class="fa fa-check"></i><b>2.1.2</b> Selecting an element</a></li>
<li class="chapter" data-level="2.1.3" data-path="summarizing-data.html"><a href="summarizing-data.html#adding-a-row-or-column"><i class="fa fa-check"></i><b>2.1.3</b> Adding a row or column</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarizing-data.html"><a href="summarizing-data.html#creating-or-modifying-variables-using-mutate"><i class="fa fa-check"></i><b>2.2</b> Creating or modifying variables using <code>mutate()</code></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="summarizing-data.html"><a href="summarizing-data.html#remove-a-column-using-the-select-function"><i class="fa fa-check"></i><b>2.2.1</b> Remove a column using the select() function</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarizing-data.html"><a href="summarizing-data.html#tidyverse-in-action"><i class="fa fa-check"></i><b>2.3</b> Tidyverse in action</a></li>
<li class="chapter" data-level="2.4" data-path="summarizing-data.html"><a href="summarizing-data.html#looking-at-individual-variables-using-pull-and-head"><i class="fa fa-check"></i><b>2.4</b> Looking at individual variables using pull() and head()</a></li>
<li class="chapter" data-level="2.5" data-path="summarizing-data.html"><a href="summarizing-data.html#frequency-distributions"><i class="fa fa-check"></i><b>2.5</b> Computing a frequency distribution (Section @ref(frequency-distributions))</a></li>
<li class="chapter" data-level="2.6" data-path="summarizing-data.html"><a href="summarizing-data.html#cumulative-distributions"><i class="fa fa-check"></i><b>2.6</b> Computing a cumulative distribution (Section @ref(cumulative-distributions))</a></li>
<li class="chapter" data-level="2.7" data-path="summarizing-data.html"><a href="summarizing-data.html#data-cleaning-and-tidying-with-r"><i class="fa fa-check"></i><b>2.7</b> Data cleaning and tidying with R</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="summarizing-data.html"><a href="summarizing-data.html#statistics-attitude-data-from-course-survey"><i class="fa fa-check"></i><b>2.7.1</b> Statistics attitude data from course survey</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-visualization.html"><a href="data-visualization.html"><i class="fa fa-check"></i><b>3</b> Data visualization using R (with Anna Khazenzon)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-visualization.html"><a href="data-visualization.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>3.1</b> The grammar of graphics</a></li>
<li class="chapter" data-level="3.2" data-path="data-visualization.html"><a href="data-visualization.html#getting-started"><i class="fa fa-check"></i><b>3.2</b> Getting started</a></li>
<li class="chapter" data-level="3.3" data-path="data-visualization.html"><a href="data-visualization.html#lets-think-through-a-visualization"><i class="fa fa-check"></i><b>3.3</b> Let’s think through a visualization</a></li>
<li class="chapter" data-level="3.4" data-path="data-visualization.html"><a href="data-visualization.html#plotting-the-distribution-of-a-single-variable"><i class="fa fa-check"></i><b>3.4</b> Plotting the distribution of a single variable</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-visualization.html"><a href="data-visualization.html#histogram"><i class="fa fa-check"></i><b>3.4.1</b> Histogram</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-visualization.html"><a href="data-visualization.html#density-plot"><i class="fa fa-check"></i><b>3.4.2</b> Density plot</a></li>
<li class="chapter" data-level="3.4.3" data-path="data-visualization.html"><a href="data-visualization.html#bar-vs.-line-plots"><i class="fa fa-check"></i><b>3.4.3</b> Bar vs. line plots</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-visualization.html"><a href="data-visualization.html#plots-with-two-variables"><i class="fa fa-check"></i><b>3.5</b> Plots with two variables</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-visualization.html"><a href="data-visualization.html#adding-on-variables"><i class="fa fa-check"></i><b>3.5.1</b> Adding on variables</a></li>
<li class="chapter" data-level="3.5.2" data-path="data-visualization.html"><a href="data-visualization.html#plotting-dispersion"><i class="fa fa-check"></i><b>3.5.2</b> Plotting dispersion</a></li>
<li class="chapter" data-level="3.5.3" data-path="data-visualization.html"><a href="data-visualization.html#scatter-plot"><i class="fa fa-check"></i><b>3.5.3</b> Scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-visualization.html"><a href="data-visualization.html#creating-a-more-complex-plot"><i class="fa fa-check"></i><b>3.6</b> Creating a more complex plot</a></li>
<li class="chapter" data-level="3.7" data-path="data-visualization.html"><a href="data-visualization.html#additional-reading-and-resources"><i class="fa fa-check"></i><b>3.7</b> Additional reading and resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html"><i class="fa fa-check"></i><b>4</b> Fitting simple models using R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#mean"><i class="fa fa-check"></i><b>4.1</b> Mean</a></li>
<li class="chapter" data-level="4.2" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#median"><i class="fa fa-check"></i><b>4.2</b> Median</a></li>
<li class="chapter" data-level="4.3" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#mode"><i class="fa fa-check"></i><b>4.3</b> Mode</a></li>
<li class="chapter" data-level="4.4" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#variability"><i class="fa fa-check"></i><b>4.4</b> Variability</a></li>
<li class="chapter" data-level="4.5" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#z-scores"><i class="fa fa-check"></i><b>4.5</b> Z-scores</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html"><i class="fa fa-check"></i><b>5</b> Probability in R (with Lucy King)</a>
<ul>
<li class="chapter" data-level="5.1" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html#basic-probability-calculations"><i class="fa fa-check"></i><b>5.1</b> Basic probability calculations</a></li>
<li class="chapter" data-level="5.2" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html#empirical-frequency"><i class="fa fa-check"></i><b>5.2</b> Empirical frequency (Section @ref(empirical-frequency))</a></li>
<li class="chapter" data-level="5.3" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html#conditional-probability"><i class="fa fa-check"></i><b>5.3</b> Conditional probability (Section @ref(conditional-probability))</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sampling-in-r.html"><a href="sampling-in-r.html"><i class="fa fa-check"></i><b>6</b> Sampling in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#samplingerror"><i class="fa fa-check"></i><b>6.1</b> Sampling error (Section @ref(samplingerror))</a></li>
<li class="chapter" data-level="6.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#central-limit-theorem"><i class="fa fa-check"></i><b>6.2</b> Central limit theorem</a></li>
<li class="chapter" data-level="6.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#confidence-intervals"><i class="fa fa-check"></i><b>6.3</b> Confidence intervals (Section @ref(confidence-intervals))</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html"><i class="fa fa-check"></i><b>7</b> Resampling and simulation in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html#generating-random-numbers"><i class="fa fa-check"></i><b>7.1</b> Generating random samples (Section @ref(generating-random-numbers))</a></li>
<li class="chapter" data-level="7.2" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html#simulating-the-maximum-finishing-time"><i class="fa fa-check"></i><b>7.2</b> Simulating the maximum finishing time</a></li>
<li class="chapter" data-level="7.3" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html#the-bootstrap"><i class="fa fa-check"></i><b>7.3</b> The bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="hypothesis-testing-in-r.html"><a href="hypothesis-testing-in-r.html"><i class="fa fa-check"></i><b>8</b> Hypothesis testing in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="hypothesis-testing-in-r.html"><a href="hypothesis-testing-in-r.html#randomization-very-simple"><i class="fa fa-check"></i><b>8.1</b> Simple example: Coin-flipping (Section @ref(randomization-very-simple))</a></li>
<li class="chapter" data-level="8.2" data-path="hypothesis-testing-in-r.html"><a href="hypothesis-testing-in-r.html#simulating-p-values"><i class="fa fa-check"></i><b>8.2</b> Simulating p-values</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html"><i class="fa fa-check"></i><b>9</b> Statistical power in R</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#computing-confidence-intervals"><i class="fa fa-check"></i><b>9.1</b> Computing confidence intervals</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#theoretical"><i class="fa fa-check"></i><b>9.1.1</b> Theoretical</a></li>
<li class="chapter" data-level="9.1.2" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#bootstrap"><i class="fa fa-check"></i><b>9.1.2</b> Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#effect-size"><i class="fa fa-check"></i><b>9.2</b> Effect Size</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#cohens-d"><i class="fa fa-check"></i><b>9.2.1</b> Cohen’s d</a></li>
<li class="chapter" data-level="9.2.2" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#pearsons-r"><i class="fa fa-check"></i><b>9.2.2</b> Pearson’s r</a></li>
<li class="chapter" data-level="9.2.3" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#odds-ratio"><i class="fa fa-check"></i><b>9.2.3</b> Odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#power-analysis"><i class="fa fa-check"></i><b>9.3</b> Power analysis</a></li>
<li class="chapter" data-level="9.4" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#power-curves"><i class="fa fa-check"></i><b>9.4</b> Power curves</a></li>
<li class="chapter" data-level="9.5" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#simulating-statistical-power"><i class="fa fa-check"></i><b>9.5</b> Simulating statistical power</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html"><i class="fa fa-check"></i><b>10</b> Bayesian statistics in R</a>
<ul>
<li class="chapter" data-level="10.1" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html#doing-bayesian-estimation"><i class="fa fa-check"></i><b>10.1</b> A simple example (Section @ref(doing-bayesian-estimation))</a></li>
<li class="chapter" data-level="10.2" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html#estimating-posterior-distributions"><i class="fa fa-check"></i><b>10.2</b> Estimating posterior distributions (Section @ref(estimating-posterior-distributions))</a></li>
<li class="chapter" data-level="10.3" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html#Bayes-factors"><i class="fa fa-check"></i><b>10.3</b> Bayes factors (Section @ref(Bayes-factors))</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modeling-categorical-relationships-in-r.html"><a href="modeling-categorical-relationships-in-r.html"><i class="fa fa-check"></i><b>11</b> Modeling categorical relationships in R</a>
<ul>
<li class="chapter" data-level="11.1" data-path="modeling-categorical-relationships-in-r.html"><a href="modeling-categorical-relationships-in-r.html#chi-squared-test"><i class="fa fa-check"></i><b>11.1</b> The Pearson Chi-squared test (Section @ref(chi-squared-test))</a></li>
<li class="chapter" data-level="11.2" data-path="modeling-categorical-relationships-in-r.html"><a href="modeling-categorical-relationships-in-r.html#two-way-test"><i class="fa fa-check"></i><b>11.2</b> Two-way tests (Section @ref(two-way-test})</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html"><i class="fa fa-check"></i><b>12</b> Modeling continuous relationships in R</a>
<ul>
<li class="chapter" data-level="12.1" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html#covariance-and-correlation"><i class="fa fa-check"></i><b>12.1</b> Computing covariance and correlation (Section @ref(covariance-and-correlation))</a></li>
<li class="chapter" data-level="12.2" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html#hate-crime-example"><i class="fa fa-check"></i><b>12.2</b> Hate crime example</a></li>
<li class="chapter" data-level="12.3" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html#robust-correlations"><i class="fa fa-check"></i><b>12.3</b> Robust correlations (Section @ref(robust-correlations))</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html"><i class="fa fa-check"></i><b>13</b> The General Linear Model in R</a>
<ul>
<li class="chapter" data-level="13.1" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#linear-regression"><i class="fa fa-check"></i><b>13.1</b> Linear regression (Section @ref(linear-regression))</a></li>
<li class="chapter" data-level="13.2" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#model-criticism"><i class="fa fa-check"></i><b>13.2</b> Model criticism and diagnostics (Section @ref(model-criticism))</a></li>
<li class="chapter" data-level="13.3" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#examples-of-problematic-model-fit"><i class="fa fa-check"></i><b>13.3</b> Examples of problematic model fit</a></li>
<li class="chapter" data-level="13.4" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#extending-regression-to-binary-outcomes."><i class="fa fa-check"></i><b>13.4</b> Extending regression to binary outcomes.</a></li>
<li class="chapter" data-level="13.5" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#cross-validation"><i class="fa fa-check"></i><b>13.5</b> Cross-validation (Section @ref(cross-validation))</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html"><i class="fa fa-check"></i><b>14</b> Comparing means in R</a>
<ul>
<li class="chapter" data-level="14.1" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#single-mean"><i class="fa fa-check"></i><b>14.1</b> Testing the value of a single mean (Section @ref(single-mean))</a></li>
<li class="chapter" data-level="14.2" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#comparing-two-means"><i class="fa fa-check"></i><b>14.2</b> Comparing two means (Section @ref(comparing-two-means))</a></li>
<li class="chapter" data-level="14.3" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#ttest-linear-model"><i class="fa fa-check"></i><b>14.3</b> The t-test as a linear model (Section @ref(ttest-linear-model))</a></li>
<li class="chapter" data-level="14.4" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#paired-ttests"><i class="fa fa-check"></i><b>14.4</b> Comparing paired observations (Section @ref(paired-ttests))</a></li>
<li class="chapter" data-level="14.5" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#ANOVA"><i class="fa fa-check"></i><b>14.5</b> Analysis of variance (Section @ref(ANOVA))</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#repeated-measures-analysis-of-variance"><i class="fa fa-check"></i><b>14.5.1</b> Repeated measures analysis of variance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="practical-statistical-modeling-in-r.html"><a href="practical-statistical-modeling-in-r.html"><i class="fa fa-check"></i><b>15</b> Practical statistical modeling in R</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An R companion to Statistical Thinking for the 21st Century</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fitting-simple-models-using-r" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Fitting simple models using R<a href="fitting-simple-models-using-r.html#fitting-simple-models-using-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter we will focus on how to compute the measures of central tendency and variability that were covered in the previous chapter. Most of these can be computed using a built-in R function, but we will show how to do them manually in order to give some intuition about how they work.</p>
<div id="mean" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Mean<a href="fitting-simple-models-using-r.html#mean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The mean is defined as the sum of values divided by the number of values being summed:</p>
<p><span class="math display">\[
\bar{X} = \frac{\sum_{i=1}^{n}x_i}{n}
\]</span></p>
<p>Let’s say that we want to obtain the mean height for adults in the NHANES database (contained in the data <code>Height</code>). We would sum the individual heights (using the <code>sum()</code> function) and then divide by the number of values:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="fitting-simple-models-using-r.html#cb142-1" tabindex="-1"></a><span class="fu">sum</span>(NHANES<span class="sc">$</span>Height) <span class="sc">/</span> <span class="fu">length</span>(NHANES<span class="sc">$</span>Height)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>This returns the value NA, because there are missing values for some rows, and the <code>sum()</code> function doesn’t automatically handle those. To address this, we could filter the data frame using <code>drop_na()</code> to drop rows with NA values for this variable:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="fitting-simple-models-using-r.html#cb144-1" tabindex="-1"></a>height_noNA <span class="ot">&lt;-</span> NHANES <span class="sc">%&gt;%</span></span>
<span id="cb144-2"><a href="fitting-simple-models-using-r.html#cb144-2" tabindex="-1"></a>  <span class="fu">drop_na</span>(Height) <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="fitting-simple-models-using-r.html#cb144-3" tabindex="-1"></a>  <span class="fu">pull</span>(Height)</span>
<span id="cb144-4"><a href="fitting-simple-models-using-r.html#cb144-4" tabindex="-1"></a></span>
<span id="cb144-5"><a href="fitting-simple-models-using-r.html#cb144-5" tabindex="-1"></a><span class="fu">sum</span>(height_noNA) <span class="sc">/</span> <span class="fu">length</span>(height_noNA)</span></code></pre></div>
<pre><code>## [1] 160.3516</code></pre>
<p>There is, of course, a built-in function in R called <code>mean()</code> that will compute the mean. Like the <code>sum()</code> function, <code>mean()</code> will return NA if there are any NA values in the data:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="fitting-simple-models-using-r.html#cb146-1" tabindex="-1"></a><span class="fu">mean</span>(NHANES<span class="sc">$</span>Height)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>The <code>mean()</code> function includes an optional argument called <code>na.rm</code> that will remove NA values if it is set to TRUE:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="fitting-simple-models-using-r.html#cb148-1" tabindex="-1"></a><span class="fu">mean</span>(NHANES<span class="sc">$</span>Height, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 160.3516</code></pre>
</div>
<div id="median" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Median<a href="fitting-simple-models-using-r.html#median" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The median is the middle value after sorting the entire set of values. Let’s use the cleand-up <code>height_noNA</code> variable created above to determine this for the NHANES height data. First we sort the data in order of their values:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="fitting-simple-models-using-r.html#cb150-1" tabindex="-1"></a>height_sorted <span class="ot">&lt;-</span> <span class="fu">sort</span>(height_noNA)</span></code></pre></div>
<p>Next we find the median value. If there is an odd number of values in the list, then this is just the value in the middle, whereas if the number of values is even then we take the average of the two middle values. We can determine whether the number of items is even by dividing the length by two and seeing if there is a remainder; we do this using the <code>%%</code> operator, which is known as the <em>modulus</em> and returns the remainder:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="fitting-simple-models-using-r.html#cb151-1" tabindex="-1"></a><span class="dv">5</span> <span class="sc">%%</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Here we will test whether the remainder is equal to one; if it is, then we will take the middle value, otherwise we will take the average of the two middle values. We can do this using an if/else structure, which executes different processes depending on which of the arguments are true:</p>
<pre><code>if (logical value) {
  functions to perform if logical value is true
} else {
  functions to perform if logical value is false

}</code></pre>
<p>Let’s do this with our data. To find the middle value when the number of items is odd, we will divide the length and then round up, using the <code>ceiling()</code> function:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="fitting-simple-models-using-r.html#cb154-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(height_sorted) <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb154-2"><a href="fitting-simple-models-using-r.html#cb154-2" tabindex="-1"></a>  <span class="co"># length of vector is odd</span></span>
<span id="cb154-3"><a href="fitting-simple-models-using-r.html#cb154-3" tabindex="-1"></a>  median_height <span class="ot">&lt;-</span> </span>
<span id="cb154-4"><a href="fitting-simple-models-using-r.html#cb154-4" tabindex="-1"></a>    height_sorted[<span class="fu">ceiling</span>(<span class="fu">length</span>(height_sorted) <span class="sc">/</span> <span class="dv">2</span>)]</span>
<span id="cb154-5"><a href="fitting-simple-models-using-r.html#cb154-5" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb154-6"><a href="fitting-simple-models-using-r.html#cb154-6" tabindex="-1"></a>  median_height <span class="ot">&lt;-</span> </span>
<span id="cb154-7"><a href="fitting-simple-models-using-r.html#cb154-7" tabindex="-1"></a>    (height_sorted[<span class="fu">length</span>(height_sorted) <span class="sc">/</span> <span class="dv">2</span>] <span class="sc">+</span> </span>
<span id="cb154-8"><a href="fitting-simple-models-using-r.html#cb154-8" tabindex="-1"></a>        height_sorted[<span class="dv">1</span> <span class="sc">+</span> <span class="fu">length</span>(height_sorted) <span class="sc">/</span> (<span class="dv">2</span>)])<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb154-9"><a href="fitting-simple-models-using-r.html#cb154-9" tabindex="-1"></a>}</span>
<span id="cb154-10"><a href="fitting-simple-models-using-r.html#cb154-10" tabindex="-1"></a></span>
<span id="cb154-11"><a href="fitting-simple-models-using-r.html#cb154-11" tabindex="-1"></a>median_height</span></code></pre></div>
<pre><code>## [1] 165.1</code></pre>
<p>We can compare this to the result from the built-in median function:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="fitting-simple-models-using-r.html#cb156-1" tabindex="-1"></a><span class="fu">median</span>(height_noNA)</span></code></pre></div>
<pre><code>## [1] 165.1</code></pre>
</div>
<div id="mode" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Mode<a href="fitting-simple-models-using-r.html#mode" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The mode is the most frequent value that occurs in a variable. R has a function called <code>mode()</code> but if you look at the help page you will see that it doesn’t actually copute the mode. In fact, R doesn’t have a built-in function to compute the mode, so we need to create one. Let start with some toy data:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="fitting-simple-models-using-r.html#cb158-1" tabindex="-1"></a>mode_test <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;c&#39;</span>)</span>
<span id="cb158-2"><a href="fitting-simple-models-using-r.html#cb158-2" tabindex="-1"></a>mode_test</span></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;b&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot;</code></pre>
<p>We can see by eye that the mode is “a” since it occurs more often than the others. To find it computationally, let’s first get the unique values</p>
<p>To do this, we first create a table with the counts for each value, using the <code>table()</code> function:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="fitting-simple-models-using-r.html#cb160-1" tabindex="-1"></a>mode_table <span class="ot">&lt;-</span> <span class="fu">table</span>(mode_test)</span>
<span id="cb160-2"><a href="fitting-simple-models-using-r.html#cb160-2" tabindex="-1"></a>mode_table</span></code></pre></div>
<pre><code>## mode_test
## a b c 
## 1 2 3</code></pre>
<p>Now we need to find the maximum value. We do this by comparing each value to the maximum of the table; this will work even if there are multiple values with the same frequency (i.e. a tie for the mode).</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="fitting-simple-models-using-r.html#cb162-1" tabindex="-1"></a>table_max <span class="ot">&lt;-</span> mode_table[mode_table <span class="sc">==</span> <span class="fu">max</span>(mode_table)]</span>
<span id="cb162-2"><a href="fitting-simple-models-using-r.html#cb162-2" tabindex="-1"></a>table_max</span></code></pre></div>
<pre><code>## c 
## 3</code></pre>
<p>This variable is a special kind of value called a <em>named vector</em>, and its name contains the value that we need to identify the mode. We can pull it out using the <code>names()</code> function:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="fitting-simple-models-using-r.html#cb164-1" tabindex="-1"></a>my_mode <span class="ot">&lt;-</span> <span class="fu">names</span>(table_max)[<span class="dv">1</span>]</span>
<span id="cb164-2"><a href="fitting-simple-models-using-r.html#cb164-2" tabindex="-1"></a>my_mode</span></code></pre></div>
<pre><code>## [1] &quot;c&quot;</code></pre>
<p>Let’s wrap this up into our own custom function:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="fitting-simple-models-using-r.html#cb166-1" tabindex="-1"></a>getmode <span class="ot">&lt;-</span> <span class="cf">function</span>(v, <span class="at">print_table=</span><span class="cn">FALSE</span>) {</span>
<span id="cb166-2"><a href="fitting-simple-models-using-r.html#cb166-2" tabindex="-1"></a>  mode_table <span class="ot">&lt;-</span> <span class="fu">table</span>(v)</span>
<span id="cb166-3"><a href="fitting-simple-models-using-r.html#cb166-3" tabindex="-1"></a>  <span class="cf">if</span> (print_table){</span>
<span id="cb166-4"><a href="fitting-simple-models-using-r.html#cb166-4" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">kable</span>(mode_table))</span>
<span id="cb166-5"><a href="fitting-simple-models-using-r.html#cb166-5" tabindex="-1"></a>  }</span>
<span id="cb166-6"><a href="fitting-simple-models-using-r.html#cb166-6" tabindex="-1"></a>  table_max <span class="ot">&lt;-</span> mode_table[mode_table <span class="sc">==</span> <span class="fu">max</span>(mode_table)]</span>
<span id="cb166-7"><a href="fitting-simple-models-using-r.html#cb166-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">names</span>(table_max))</span>
<span id="cb166-8"><a href="fitting-simple-models-using-r.html#cb166-8" tabindex="-1"></a>}</span></code></pre></div>
<p>We can then apply this to real data. Let’s apply this to the <code>MaritalStatus</code> variable in the NHANES dataset:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="fitting-simple-models-using-r.html#cb167-1" tabindex="-1"></a><span class="fu">getmode</span>(NHANES<span class="sc">$</span>MaritalStatus)</span></code></pre></div>
<pre><code>## [1] &quot;Married&quot;</code></pre>
</div>
<div id="variability" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Variability<a href="fitting-simple-models-using-r.html#variability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s first compute the <em>variance</em>, which is the average squared difference between each value and the mean. Let’s do this with our cleaned-up version of the height data, but instead of working with the entire dataset, let’s take a random sample of 150 individuals:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="fitting-simple-models-using-r.html#cb169-1" tabindex="-1"></a>height_sample <span class="ot">&lt;-</span> NHANES <span class="sc">%&gt;%</span></span>
<span id="cb169-2"><a href="fitting-simple-models-using-r.html#cb169-2" tabindex="-1"></a>  <span class="fu">drop_na</span>(Height) <span class="sc">%&gt;%</span></span>
<span id="cb169-3"><a href="fitting-simple-models-using-r.html#cb169-3" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">150</span>) <span class="sc">%&gt;%</span></span>
<span id="cb169-4"><a href="fitting-simple-models-using-r.html#cb169-4" tabindex="-1"></a>  <span class="fu">pull</span>(Height)</span></code></pre></div>
<p>First we need to obtain the sum of squared errors from the mean. In R, we can square a vector using <code>**2</code>:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="fitting-simple-models-using-r.html#cb170-1" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>((height_sample <span class="sc">-</span> <span class="fu">mean</span>(height_sample))<span class="sc">**</span><span class="dv">2</span>)</span>
<span id="cb170-2"><a href="fitting-simple-models-using-r.html#cb170-2" tabindex="-1"></a>SSE</span></code></pre></div>
<pre><code>## [1] 63419.37</code></pre>
<p>Then we divide by N - 1 to get the estimated variance:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="fitting-simple-models-using-r.html#cb172-1" tabindex="-1"></a>var_est <span class="ot">&lt;-</span> SSE<span class="sc">/</span>(<span class="fu">length</span>(height_sample) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb172-2"><a href="fitting-simple-models-using-r.html#cb172-2" tabindex="-1"></a>var_est</span></code></pre></div>
<pre><code>## [1] 425.6333</code></pre>
<p>We can compare this to the built-in <code>var()</code> function:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="fitting-simple-models-using-r.html#cb174-1" tabindex="-1"></a><span class="fu">var</span>(height_sample)</span></code></pre></div>
<pre><code>## [1] 425.6333</code></pre>
<p>We can get the <em>standard deviation</em> by simply taking the square root of the variance:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="fitting-simple-models-using-r.html#cb176-1" tabindex="-1"></a><span class="fu">sqrt</span>(var_est)</span></code></pre></div>
<pre><code>## [1] 20.63088</code></pre>
<p>Which is the same value obtained using the built-in <code>sd()</code> function:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="fitting-simple-models-using-r.html#cb178-1" tabindex="-1"></a><span class="fu">sd</span>(height_sample)</span></code></pre></div>
<pre><code>## [1] 20.63088</code></pre>
</div>
<div id="z-scores" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Z-scores<a href="fitting-simple-models-using-r.html#z-scores" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A Z-score is obtained by first subtracting the mean and then dividing by the standard deviation of a distribution. Let’s do this for the <code>height_sample</code> data.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="fitting-simple-models-using-r.html#cb180-1" tabindex="-1"></a>mean_height <span class="ot">&lt;-</span> <span class="fu">mean</span>(height_sample)</span>
<span id="cb180-2"><a href="fitting-simple-models-using-r.html#cb180-2" tabindex="-1"></a>sd_height <span class="ot">&lt;-</span> <span class="fu">sd</span>(height_sample)</span>
<span id="cb180-3"><a href="fitting-simple-models-using-r.html#cb180-3" tabindex="-1"></a></span>
<span id="cb180-4"><a href="fitting-simple-models-using-r.html#cb180-4" tabindex="-1"></a>z_height <span class="ot">&lt;-</span> (height_sample <span class="sc">-</span> mean_height)<span class="sc">/</span>sd_height</span></code></pre></div>
<p>Now let’s plot the histogram of Z-scores alongside the histogram for the original values. We will use the <code>plot_grid()</code> function from the <code>cowplot</code> library to plot the two figures alongside one another. First we need to put the values into a data frame, since <code>ggplot()</code> requires the data to be contained in a data frame.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="fitting-simple-models-using-r.html#cb181-1" tabindex="-1"></a>height_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">orig_height=</span>height_sample, </span>
<span id="cb181-2"><a href="fitting-simple-models-using-r.html#cb181-2" tabindex="-1"></a>                        <span class="at">z_height=</span>z_height)</span>
<span id="cb181-3"><a href="fitting-simple-models-using-r.html#cb181-3" tabindex="-1"></a></span>
<span id="cb181-4"><a href="fitting-simple-models-using-r.html#cb181-4" tabindex="-1"></a><span class="co"># create individual plots</span></span>
<span id="cb181-5"><a href="fitting-simple-models-using-r.html#cb181-5" tabindex="-1"></a>plot_orig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(height_df, <span class="fu">aes</span>(orig_height)) <span class="sc">+</span> </span>
<span id="cb181-6"><a href="fitting-simple-models-using-r.html#cb181-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb181-7"><a href="fitting-simple-models-using-r.html#cb181-7" tabindex="-1"></a>plot_z <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(height_df, <span class="fu">aes</span>(z_height)) <span class="sc">+</span> </span>
<span id="cb181-8"><a href="fitting-simple-models-using-r.html#cb181-8" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb181-9"><a href="fitting-simple-models-using-r.html#cb181-9" tabindex="-1"></a></span>
<span id="cb181-10"><a href="fitting-simple-models-using-r.html#cb181-10" tabindex="-1"></a><span class="co"># combine into a single figure</span></span>
<span id="cb181-11"><a href="fitting-simple-models-using-r.html#cb181-11" tabindex="-1"></a><span class="fu">plot_grid</span>(plot_orig, plot_z)</span></code></pre></div>
<p><img src="StatsThinking21_files/figure-html/unnamed-chunk-89-1.png" width="768" /></p>
<p>You will notice that the shapes of the histograms are similar but not exactly the same. This occurs because the binning is slightly different between the two sets of values. However, if we plot them against one another in a scatterplot, we will see that there is a direct linear relation between the two sets of values:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="fitting-simple-models-using-r.html#cb182-1" tabindex="-1"></a><span class="fu">ggplot</span>(height_df, <span class="fu">aes</span>(orig_height, z_height)) <span class="sc">+</span> </span>
<span id="cb182-2"><a href="fitting-simple-models-using-r.html#cb182-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="StatsThinking21_files/figure-html/unnamed-chunk-90-1.png" width="384" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="probability-in-r-with-lucy-king.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/statsthinking21/statsthinking21-R/edit/master/04-FittingSimpleModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["StatsThinking21.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
