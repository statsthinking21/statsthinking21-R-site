<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Summarizing data using R (with Lucy King) | Statistical Thinking for the 21st Century</title>
  <meta name="description" content="A book about statistics." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Summarizing data using R (with Lucy King) | Statistical Thinking for the 21st Century" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A book about statistics." />
  <meta name="github-repo" content="poldrack/psych10-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Summarizing data using R (with Lucy King) | Statistical Thinking for the 21st Century" />
  
  <meta name="twitter:description" content="A book about statistics." />
  

<meta name="author" content="Copyright 2019 Russell A. Poldrack" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-r.html"/>
<link rel="next" href="data-visualization-using-r-with-anna-khazenzon.html"/>
<script src="book_assets/jquery-2.2.3/jquery.min.js"></script>
<link href="book_assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="book_assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-129414074-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129414074-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#why-r"><i class="fa fa-check"></i><b>0.1</b> Why R?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#the-golden-age-of-data"><i class="fa fa-check"></i><b>0.2</b> The golden age of data</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#an-open-source-book"><i class="fa fa-check"></i><b>0.3</b> An open source book</a></li>
<li class="chapter" data-level="0.4" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>0.4</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#why-programming-is-hard-to-learn"><i class="fa fa-check"></i><b>1.1</b> Why programming is hard to learn</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#use-the-web"><i class="fa fa-check"></i><b>1.1.1</b> Use the web</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#rubber-duck-debugging"><i class="fa fa-check"></i><b>1.1.2</b> Rubber duck debugging</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-rstudio"><i class="fa fa-check"></i><b>1.2</b> Using RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#getting-started-with-r"><i class="fa fa-check"></i><b>1.3</b> Getting started with R</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#variables"><i class="fa fa-check"></i><b>1.4</b> Variables</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#functions"><i class="fa fa-check"></i><b>1.5</b> Functions</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#vectors"><i class="fa fa-check"></i><b>1.6</b> Vectors</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#math-with-vectors"><i class="fa fa-check"></i><b>1.7</b> Math with vectors</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#data-frames"><i class="fa fa-check"></i><b>1.8</b> Data Frames</a></li>
<li class="chapter" data-level="1.9" data-path="introduction-to-r.html"><a href="introduction-to-r.html#using-r-libraries"><i class="fa fa-check"></i><b>1.9</b> Using R libraries</a></li>
<li class="chapter" data-level="1.10" data-path="introduction-to-r.html"><a href="introduction-to-r.html#working-with-data-files"><i class="fa fa-check"></i><b>1.10</b> Working with data files</a></li>
<li class="chapter" data-level="1.11" data-path="introduction-to-r.html"><a href="introduction-to-r.html#learning-objectives"><i class="fa fa-check"></i><b>1.11</b> Learning objectives</a></li>
<li class="chapter" data-level="1.12" data-path="introduction-to-r.html"><a href="introduction-to-r.html#suggested-readings-and-videos"><i class="fa fa-check"></i><b>1.12</b> Suggested readings and videos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html"><i class="fa fa-check"></i><b>2</b> Summarizing data using R (with Lucy King)</a><ul>
<li class="chapter" data-level="2.1" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#introduction-to-the-tidyverse"><i class="fa fa-check"></i><b>2.1</b> Introduction to the Tidyverse</a><ul>
<li class="chapter" data-level="2.1.1" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#making-a-data-frame-using-tibble"><i class="fa fa-check"></i><b>2.1.1</b> Making a data frame using tibble()</a></li>
<li class="chapter" data-level="2.1.2" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#selecting-an-element"><i class="fa fa-check"></i><b>2.1.2</b> Selecting an element</a></li>
<li class="chapter" data-level="2.1.3" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#adding-a-row-or-column"><i class="fa fa-check"></i><b>2.1.3</b> Adding a row or column</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#creating-or-modifying-variables-using-mutate"><i class="fa fa-check"></i><b>2.2</b> Creating or modifying variables using <code>mutate()</code></a><ul>
<li class="chapter" data-level="2.2.1" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#remove-a-column-using-the-select-function"><i class="fa fa-check"></i><b>2.2.1</b> Remove a column using the select() function</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#tidyverse-in-action"><i class="fa fa-check"></i><b>2.3</b> Tidyverse in action</a></li>
<li class="chapter" data-level="2.4" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#looking-at-individual-variables-using-pull-and-head"><i class="fa fa-check"></i><b>2.4</b> Looking at individual variables using pull() and head()</a></li>
<li class="chapter" data-level="2.5" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#computing-a-frequency-distribution-section-reffrequency-distributions"><i class="fa fa-check"></i><b>2.5</b> Computing a frequency distribution (Section @ref(frequency-distributions))</a></li>
<li class="chapter" data-level="2.6" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#computing-a-cumulative-distribution-section-refcumulative-distributions"><i class="fa fa-check"></i><b>2.6</b> Computing a cumulative distribution (Section @ref(cumulative-distributions))</a></li>
<li class="chapter" data-level="2.7" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#data-cleaning-and-tidying-with-r"><i class="fa fa-check"></i><b>2.7</b> Data cleaning and tidying with R</a><ul>
<li class="chapter" data-level="2.7.1" data-path="summarizing-data-using-r-with-lucy-king.html"><a href="summarizing-data-using-r-with-lucy-king.html#statistics-attitude-data-from-course-survey"><i class="fa fa-check"></i><b>2.7.1</b> Statistics attitude data from course survey</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html"><i class="fa fa-check"></i><b>3</b> Data visualization using R (with Anna Khazenzon)</a><ul>
<li class="chapter" data-level="3.1" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#the-grammar-of-graphics"><i class="fa fa-check"></i><b>3.1</b> The grammar of graphics</a></li>
<li class="chapter" data-level="3.2" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#getting-started"><i class="fa fa-check"></i><b>3.2</b> Getting started</a></li>
<li class="chapter" data-level="3.3" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#lets-think-through-a-visualization"><i class="fa fa-check"></i><b>3.3</b> Let’s think through a visualization</a></li>
<li class="chapter" data-level="3.4" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#plotting-the-distribution-of-a-single-variable"><i class="fa fa-check"></i><b>3.4</b> Plotting the distribution of a single variable</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#histogram"><i class="fa fa-check"></i><b>3.4.1</b> Histogram</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#density-plot"><i class="fa fa-check"></i><b>3.4.2</b> Density plot</a></li>
<li class="chapter" data-level="3.4.3" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#bar-vs.line-plots"><i class="fa fa-check"></i><b>3.4.3</b> Bar vs. line plots</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#plots-with-two-variables"><i class="fa fa-check"></i><b>3.5</b> Plots with two variables</a><ul>
<li class="chapter" data-level="3.5.1" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#adding-on-variables"><i class="fa fa-check"></i><b>3.5.1</b> Adding on variables</a></li>
<li class="chapter" data-level="3.5.2" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#plotting-dispersion"><i class="fa fa-check"></i><b>3.5.2</b> Plotting dispersion</a></li>
<li class="chapter" data-level="3.5.3" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#scatter-plot"><i class="fa fa-check"></i><b>3.5.3</b> Scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#creating-a-more-complex-plot"><i class="fa fa-check"></i><b>3.6</b> Creating a more complex plot</a></li>
<li class="chapter" data-level="3.7" data-path="data-visualization-using-r-with-anna-khazenzon.html"><a href="data-visualization-using-r-with-anna-khazenzon.html#additional-reading-and-resources"><i class="fa fa-check"></i><b>3.7</b> Additional reading and resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html"><i class="fa fa-check"></i><b>4</b> Fitting simple models using R</a><ul>
<li class="chapter" data-level="4.1" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#mean"><i class="fa fa-check"></i><b>4.1</b> Mean</a></li>
<li class="chapter" data-level="4.2" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#median"><i class="fa fa-check"></i><b>4.2</b> Median</a></li>
<li class="chapter" data-level="4.3" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#mode"><i class="fa fa-check"></i><b>4.3</b> Mode</a></li>
<li class="chapter" data-level="4.4" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#variability"><i class="fa fa-check"></i><b>4.4</b> Variability</a></li>
<li class="chapter" data-level="4.5" data-path="fitting-simple-models-using-r.html"><a href="fitting-simple-models-using-r.html#z-scores"><i class="fa fa-check"></i><b>4.5</b> Z-scores</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html"><i class="fa fa-check"></i><b>5</b> Probability in R (with Lucy King)</a><ul>
<li class="chapter" data-level="5.1" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html#basic-probability-calculations"><i class="fa fa-check"></i><b>5.1</b> Basic probability calculations</a></li>
<li class="chapter" data-level="5.2" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html#empirical-frequency-section-refempirical-frequency"><i class="fa fa-check"></i><b>5.2</b> Empirical frequency (Section @ref(empirical-frequency))</a></li>
<li class="chapter" data-level="5.3" data-path="probability-in-r-with-lucy-king.html"><a href="probability-in-r-with-lucy-king.html#conditional-probability-section-refconditional-probability"><i class="fa fa-check"></i><b>5.3</b> Conditional probability (Section @ref(conditional-probability))</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="sampling-in-r.html"><a href="sampling-in-r.html"><i class="fa fa-check"></i><b>6</b> Sampling in R</a><ul>
<li class="chapter" data-level="6.1" data-path="sampling-in-r.html"><a href="sampling-in-r.html#sampling-error-section-refsamplingerror"><i class="fa fa-check"></i><b>6.1</b> Sampling error (Section @ref(samplingerror))</a></li>
<li class="chapter" data-level="6.2" data-path="sampling-in-r.html"><a href="sampling-in-r.html#central-limit-theorem"><i class="fa fa-check"></i><b>6.2</b> Central limit theorem</a></li>
<li class="chapter" data-level="6.3" data-path="sampling-in-r.html"><a href="sampling-in-r.html#confidence-intervals-section-refconfidence-intervals"><i class="fa fa-check"></i><b>6.3</b> Confidence intervals (Section @ref(confidence-intervals))</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html"><i class="fa fa-check"></i><b>7</b> Resampling and simulation in R</a><ul>
<li class="chapter" data-level="7.1" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html#generating-random-samples-section-refgenerating-random-numbers"><i class="fa fa-check"></i><b>7.1</b> Generating random samples (Section @ref(generating-random-numbers))</a></li>
<li class="chapter" data-level="7.2" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html#simulating-the-maximum-finishing-time"><i class="fa fa-check"></i><b>7.2</b> Simulating the maximum finishing time</a></li>
<li class="chapter" data-level="7.3" data-path="resampling-and-simulation-in-r.html"><a href="resampling-and-simulation-in-r.html#the-bootstrap"><i class="fa fa-check"></i><b>7.3</b> The bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="hypothesis-testing-in-r.html"><a href="hypothesis-testing-in-r.html"><i class="fa fa-check"></i><b>8</b> Hypothesis testing in R</a><ul>
<li class="chapter" data-level="8.1" data-path="hypothesis-testing-in-r.html"><a href="hypothesis-testing-in-r.html#simple-example-coin-flipping-section-refrandomization-very-simple"><i class="fa fa-check"></i><b>8.1</b> Simple example: Coin-flipping (Section @ref(randomization-very-simple))</a></li>
<li class="chapter" data-level="8.2" data-path="hypothesis-testing-in-r.html"><a href="hypothesis-testing-in-r.html#simulating-p-values"><i class="fa fa-check"></i><b>8.2</b> Simulating p-values</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html"><i class="fa fa-check"></i><b>9</b> Statistical power in R</a><ul>
<li class="chapter" data-level="9.1" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#computing-confidence-intervals"><i class="fa fa-check"></i><b>9.1</b> Computing confidence intervals</a><ul>
<li class="chapter" data-level="9.1.1" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#theoretical"><i class="fa fa-check"></i><b>9.1.1</b> Theoretical</a></li>
<li class="chapter" data-level="9.1.2" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#bootstrap"><i class="fa fa-check"></i><b>9.1.2</b> Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#effect-size"><i class="fa fa-check"></i><b>9.2</b> Effect Size</a><ul>
<li class="chapter" data-level="9.2.1" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#cohens-d"><i class="fa fa-check"></i><b>9.2.1</b> Cohen’s d</a></li>
<li class="chapter" data-level="9.2.2" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#pearsons-r"><i class="fa fa-check"></i><b>9.2.2</b> Pearson’s r</a></li>
<li class="chapter" data-level="9.2.3" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#odds-ratio"><i class="fa fa-check"></i><b>9.2.3</b> Odds ratio</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#power-analysis"><i class="fa fa-check"></i><b>9.3</b> Power analysis</a></li>
<li class="chapter" data-level="9.4" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#power-curves"><i class="fa fa-check"></i><b>9.4</b> Power curves</a></li>
<li class="chapter" data-level="9.5" data-path="statistical-power-in-r.html"><a href="statistical-power-in-r.html#simulating-statistical-power"><i class="fa fa-check"></i><b>9.5</b> Simulating statistical power</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html"><i class="fa fa-check"></i><b>10</b> Bayesian statistics in R</a><ul>
<li class="chapter" data-level="10.1" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html#a-simple-example-section-refdoing-bayesian-estimation"><i class="fa fa-check"></i><b>10.1</b> A simple example (Section @ref(doing-bayesian-estimation))</a></li>
<li class="chapter" data-level="10.2" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html#estimating-posterior-distributions-section-refestimating-posterior-distributions"><i class="fa fa-check"></i><b>10.2</b> Estimating posterior distributions (Section @ref(estimating-posterior-distributions))</a></li>
<li class="chapter" data-level="10.3" data-path="bayesian-statistics-in-r.html"><a href="bayesian-statistics-in-r.html#bayes-factors-section-refbayes-factors"><i class="fa fa-check"></i><b>10.3</b> Bayes factors (Section @ref(Bayes-factors))</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="modeling-categorical-relationships-in-r.html"><a href="modeling-categorical-relationships-in-r.html"><i class="fa fa-check"></i><b>11</b> Modeling categorical relationships in R</a><ul>
<li class="chapter" data-level="11.1" data-path="modeling-categorical-relationships-in-r.html"><a href="modeling-categorical-relationships-in-r.html#the-pearson-chi-squared-test-section-refchi-squared-test"><i class="fa fa-check"></i><b>11.1</b> The Pearson Chi-squared test (Section @ref(chi-squared-test))</a></li>
<li class="chapter" data-level="11.2" data-path="modeling-categorical-relationships-in-r.html"><a href="modeling-categorical-relationships-in-r.html#two-way-tests-section-reftwo-way-test"><i class="fa fa-check"></i><b>11.2</b> Two-way tests (Section @ref(two-way-test})</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html"><i class="fa fa-check"></i><b>12</b> Modeling continuous relationships in R</a><ul>
<li class="chapter" data-level="12.1" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html#computing-covariance-and-correlation-section-refcovariance-and-correlation"><i class="fa fa-check"></i><b>12.1</b> Computing covariance and correlation (Section @ref(covariance-and-correlation))</a></li>
<li class="chapter" data-level="12.2" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html#hate-crime-example"><i class="fa fa-check"></i><b>12.2</b> Hate crime example</a></li>
<li class="chapter" data-level="12.3" data-path="modeling-continuous-relationships-in-r.html"><a href="modeling-continuous-relationships-in-r.html#robust-correlations-section-refrobust-correlations"><i class="fa fa-check"></i><b>12.3</b> Robust correlations (Section @ref(robust-correlations))</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html"><i class="fa fa-check"></i><b>13</b> The General Linear Model in R</a><ul>
<li class="chapter" data-level="13.1" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#linear-regression-section-reflinear-regression"><i class="fa fa-check"></i><b>13.1</b> Linear regression (Section @ref(linear-regression))</a></li>
<li class="chapter" data-level="13.2" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#model-criticism-and-diagnostics-section-refmodel-criticism"><i class="fa fa-check"></i><b>13.2</b> Model criticism and diagnostics (Section @ref(model-criticism))</a></li>
<li class="chapter" data-level="13.3" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#examples-of-problematic-model-fit"><i class="fa fa-check"></i><b>13.3</b> Examples of problematic model fit</a></li>
<li class="chapter" data-level="13.4" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#extending-regression-to-binary-outcomes."><i class="fa fa-check"></i><b>13.4</b> Extending regression to binary outcomes.</a></li>
<li class="chapter" data-level="13.5" data-path="the-general-linear-model-in-r.html"><a href="the-general-linear-model-in-r.html#cross-validation-section-refcross-validation"><i class="fa fa-check"></i><b>13.5</b> Cross-validation (Section @ref(cross-validation))</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html"><i class="fa fa-check"></i><b>14</b> Comparing means in R</a><ul>
<li class="chapter" data-level="14.1" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#testing-the-value-of-a-single-mean-section-refsingle-mean"><i class="fa fa-check"></i><b>14.1</b> Testing the value of a single mean (Section @ref(single-mean))</a></li>
<li class="chapter" data-level="14.2" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#comparing-two-means-section-refcomparing-two-means"><i class="fa fa-check"></i><b>14.2</b> Comparing two means (Section @ref(comparing-two-means))</a></li>
<li class="chapter" data-level="14.3" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#the-t-test-as-a-linear-model-section-refttest-linear-model"><i class="fa fa-check"></i><b>14.3</b> The t-test as a linear model (Section @ref(ttest-linear-model))</a></li>
<li class="chapter" data-level="14.4" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#comparing-paired-observations-section-refpaired-ttests"><i class="fa fa-check"></i><b>14.4</b> Comparing paired observations (Section @ref(paired-ttests))</a></li>
<li class="chapter" data-level="14.5" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#analysis-of-variance-section-refanova"><i class="fa fa-check"></i><b>14.5</b> Analysis of variance (Section @ref(ANOVA))</a><ul>
<li class="chapter" data-level="14.5.1" data-path="comparing-means-in-r.html"><a href="comparing-means-in-r.html#repeated-measures-analysis-of-variance"><i class="fa fa-check"></i><b>14.5.1</b> Repeated measures analysis of variance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="practical-statistical-modeling-in-r.html"><a href="practical-statistical-modeling-in-r.html"><i class="fa fa-check"></i><b>15</b> Practical statistical modeling in R</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Thinking for the 21st Century</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="summarizing-data-using-r-with-lucy-king" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Summarizing data using R (with Lucy King)</h1>
<p>This chapter will introduce you to how to summarize data using R, as well as providing an introduction to a popular set of R tools known as the “Tidyverse.”</p>
<p>Before doing anything else we need to load the libraries that we will use in this notebook.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw">library</span>(cowplot)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">123456</span>)</a>
<a class="sourceLine" id="cb35-5" data-line-number="5">opts_chunk<span class="op">$</span><span class="kw">set</span>(<span class="dt">tidy.opts=</span><span class="kw">list</span>(<span class="dt">width.cutoff=</span><span class="dv">80</span>))</a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="kw">options</span>(<span class="dt">tibble.width =</span> <span class="dv">60</span>)</a></code></pre></div>
<p>We will use the NHANES dataset for several of our examples, so let’s load the library that contains the data.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="co"># load the NHANES data library</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="co"># first unload it if it&#39;s already loaded, to make sure</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="co"># we have a clean version</span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="kw">rm</span>(<span class="st">&#39;NHANES&#39;</span>)</a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="kw">library</span>(NHANES)</a>
<a class="sourceLine" id="cb36-6" data-line-number="6"><span class="kw">dim</span>(NHANES)</a></code></pre></div>
<pre><code>## [1] 10000    76</code></pre>
<div id="introduction-to-the-tidyverse" class="section level2">
<h2><span class="header-section-number">2.1</span> Introduction to the Tidyverse</h2>
<p>In this chapter we will introduce a way of working with data in R that is often referred to as the “Tidyverse.” This comprises a set of packages that provide various tools for working with data, as well as a few special ways of using those functions</p>
<div id="making-a-data-frame-using-tibble" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Making a data frame using tibble()</h3>
<p>The tidyverse provides its own version of a data frame, which is known as a <em>tibble</em>. A tibble is a data frame but with some smart tweaks that make it easier to work with, expecially when using functions from the tidyverse. See here for more information on the function <code>tibble()</code>: <a href="https://r4ds.had.co.nz/tibbles.html" class="uri">https://r4ds.had.co.nz/tibbles.html</a></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="co"># first create the individual variables</span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2">n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;russ&quot;</span>, <span class="st">&quot;lucy&quot;</span>, <span class="st">&quot;jaclyn&quot;</span>, <span class="st">&quot;tyler&quot;</span>)</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb38-4" data-line-number="4">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb38-5" data-line-number="5">z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb38-6" data-line-number="6"></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="co"># create the data frame</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8">my_data_frame &lt;-</a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="st">  </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb38-10" data-line-number="10">    n, <span class="co">#list each of your columns in the order you want them</span></a>
<a class="sourceLine" id="cb38-11" data-line-number="11">    x,</a>
<a class="sourceLine" id="cb38-12" data-line-number="12">    y,</a>
<a class="sourceLine" id="cb38-13" data-line-number="13">    z</a>
<a class="sourceLine" id="cb38-14" data-line-number="14">  )</a>
<a class="sourceLine" id="cb38-15" data-line-number="15"></a>
<a class="sourceLine" id="cb38-16" data-line-number="16">my_data_frame</a></code></pre></div>
<pre><code>## # A tibble: 4 x 4
##   n          x     y     z
##   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 russ       1     4     7
## 2 lucy       2     5     8
## 3 jaclyn     3     6     9
## 4 tyler      4     7    10</code></pre>
<p>Take a quick look at the properties of the data frame using <code>glimpse()</code>:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">glimpse</span>(my_data_frame) </a></code></pre></div>
<pre><code>## Observations: 4
## Variables: 4
## $ n &lt;chr&gt; &quot;russ&quot;, &quot;lucy&quot;, &quot;jaclyn&quot;, &quot;tyler&quot;
## $ x &lt;dbl&gt; 1, 2, 3, 4
## $ y &lt;dbl&gt; 4, 5, 6, 7
## $ z &lt;dbl&gt; 7, 8, 9, 10</code></pre>
</div>
<div id="selecting-an-element" class="section level3">
<h3><span class="header-section-number">2.1.2</span> Selecting an element</h3>
<p>There are various ways to access the contents within a data frame.</p>
<div id="selecting-a-row-or-column-by-name" class="section level4">
<h4><span class="header-section-number">2.1.2.1</span> Selecting a row or column by name</h4>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">my_data_frame<span class="op">$</span>x</a></code></pre></div>
<pre><code>## [1] 1 2 3 4</code></pre>
<p>The first index refers to the row, the second to the column.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">my_data_frame[<span class="dv">1</span>, <span class="dv">2</span>]</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       x
##   &lt;dbl&gt;
## 1     1</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">my_data_frame[<span class="dv">2</span>, <span class="dv">3</span>]</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       y
##   &lt;dbl&gt;
## 1     5</code></pre>
</div>
<div id="selecting-a-row-or-column-by-index" class="section level4">
<h4><span class="header-section-number">2.1.2.2</span> Selecting a row or column by index</h4>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">my_data_frame[<span class="dv">1</span>, ]</a></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   n         x     y     z
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 russ      1     4     7</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">my_data_frame[, <span class="dv">1</span>]</a></code></pre></div>
<pre><code>## # A tibble: 4 x 1
##   n     
##   &lt;chr&gt; 
## 1 russ  
## 2 lucy  
## 3 jaclyn
## 4 tyler</code></pre>
</div>
<div id="select-a-set-of-rows" class="section level4">
<h4><span class="header-section-number">2.1.2.3</span> Select a set of rows</h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">my_data_frame <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) </a></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   n         x     y     z
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 russ      1     4     7
## 2 lucy      2     5     8</code></pre>
<p><code>slice()</code> is a function that selects out rows based on their row number.</p>
<p>You will also notice something we haven’t discussed before: <code>%&gt;%</code>. This is called a “pipe”, which is commonly used within the tidyverse; you can read more <a href="http://magrittr.tidyverse.org/">here</a>. A pipe takes the output from one command and feeds it as input to the next command. In this case, simply writing the name of the data frame (my_data_frame) causes it to be input to the <code>slice()</code> command following the pipe. The benefit of pipes will become especially apparent when we want to start stringing together multiple data processing operations into a single command.</p>
<p>In the previous example, no new variable was created - the output was simply printed to the screen, just like it would be if you typed the name of the variable. If you wanted to save it to a new variable, you would use the <code>&lt;-</code> assignment operator, like this:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">my_data_frame_slice &lt;-<span class="st"> </span>my_data_frame <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-2" data-line-number="2"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb54-3" data-line-number="3"></a>
<a class="sourceLine" id="cb54-4" data-line-number="4">my_data_frame_slice</a></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   n         x     y     z
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 russ      1     4     7
## 2 lucy      2     5     8</code></pre>
</div>
<div id="select-a-set-of-rows-based-on-specific-values" class="section level4">
<h4><span class="header-section-number">2.1.2.4</span> Select a set of rows based on specific value(s)</h4>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">my_data_frame <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">==</span><span class="st"> &quot;russ&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   n         x     y     z
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 russ      1     4     7</code></pre>
<p><code>filter()</code> is a function that retains only those rows that meet your stated criteria. We can also filter for multiple criteria at once — in this example, the <code>|</code> symbol indicates “or”:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">my_data_frame <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">==</span><span class="st"> &quot;russ&quot;</span> <span class="op">|</span><span class="st"> </span>n <span class="op">==</span><span class="st"> &quot;lucy&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   n         x     y     z
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 russ      1     4     7
## 2 lucy      2     5     8</code></pre>
</div>
<div id="select-a-set-of-columns" class="section level4">
<h4><span class="header-section-number">2.1.2.5</span> Select a set of columns</h4>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">my_data_frame <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(x<span class="op">:</span>y)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##       x     y
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1     4
## 2     2     5
## 3     3     6
## 4     4     7</code></pre>
<p><code>select()</code> is a function that selects out only those columns you specify using their names</p>
<p>You can also specify a vector of columns to select.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">my_data_frame <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="kw">c</span>(x,z))</a></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##       x     z
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1     7
## 2     2     8
## 3     3     9
## 4     4    10</code></pre>
</div>
</div>
<div id="adding-a-row-or-column" class="section level3">
<h3><span class="header-section-number">2.1.3</span> Adding a row or column</h3>
<p>add a named row</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">tiffany_data_frame &lt;-</a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb64-3" data-line-number="3">    <span class="dt">n =</span> <span class="st">&quot;tiffany&quot;</span>,</a>
<a class="sourceLine" id="cb64-4" data-line-number="4">    <span class="dt">x =</span> <span class="dv">13</span>,</a>
<a class="sourceLine" id="cb64-5" data-line-number="5">    <span class="dt">y =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb64-6" data-line-number="6">    <span class="dt">z =</span> <span class="dv">15</span></a>
<a class="sourceLine" id="cb64-7" data-line-number="7">  )</a>
<a class="sourceLine" id="cb64-8" data-line-number="8"></a>
<a class="sourceLine" id="cb64-9" data-line-number="9">my_data_frame <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-10" data-line-number="10"><span class="st">  </span><span class="kw">bind_rows</span>(tiffany_data_frame)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   n           x     y     z
##   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 russ        1     4     7
## 2 lucy        2     5     8
## 3 jaclyn      3     6     9
## 4 tyler       4     7    10
## 5 tiffany    13    14    15</code></pre>
<p><code>bind_rows()</code> is a function that combines the rows from another dataframe to the current dataframe</p>
</div>
</div>
<div id="creating-or-modifying-variables-using-mutate" class="section level2">
<h2><span class="header-section-number">2.2</span> Creating or modifying variables using <code>mutate()</code></h2>
<p>Often we will want to either create a new variable based on an existing variable, or modify the value of an existing variable. Within the tidyverse, we do this using a function called <code>mutate()</code>. Let’s start with a toy example by creating a data frame containing a single variable.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">toy_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="kw">glimpse</span>(toy_df)</a></code></pre></div>
<pre><code>## Observations: 4
## Variables: 1
## $ x &lt;dbl&gt; 1, 2, 3, 4</code></pre>
<p>Let’s say that we wanted to create a new variable called <code>y</code> that would contain the value of x multiplied by 10. We could do this using <code>mutate()</code> and then assign the result back to the same data frame:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">toy_df &lt;-<span class="st"> </span>toy_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb68-2" data-line-number="2"><span class="st">  </span><span class="co"># create a new variable called y that contains x*10</span></a>
<a class="sourceLine" id="cb68-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> x <span class="op">*</span><span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb68-4" data-line-number="4"><span class="kw">glimpse</span>(toy_df)</a></code></pre></div>
<pre><code>## Observations: 4
## Variables: 2
## $ x &lt;dbl&gt; 1, 2, 3, 4
## $ y &lt;dbl&gt; 10, 20, 30, 40</code></pre>
<p>We could also overwrite a variable with a new value:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">toy_df2 &lt;-<span class="st"> </span>toy_df <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="st">  </span><span class="co"># create a new variable called y that contains x*10</span></a>
<a class="sourceLine" id="cb70-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> y <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb70-4" data-line-number="4"><span class="kw">glimpse</span>(toy_df2)</a></code></pre></div>
<pre><code>## Observations: 4
## Variables: 2
## $ x &lt;dbl&gt; 1, 2, 3, 4
## $ y &lt;dbl&gt; 11, 21, 31, 41</code></pre>
<p>We will use <code>mutate()</code> often so it’s an important function to understand.</p>
<p>Here we can use it with our example data frame to create a new variable that is the sum of several other variables.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">my_data_frame &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="st">  </span>my_data_frame <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total =</span> x <span class="op">+</span><span class="st"> </span>y <span class="op">+</span><span class="st"> </span>z)</a>
<a class="sourceLine" id="cb72-4" data-line-number="4"></a>
<a class="sourceLine" id="cb72-5" data-line-number="5"><span class="kw">kable</span>(my_data_frame)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">n</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">z</th>
<th align="right">total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">russ</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">7</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">lucy</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">8</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="left">jaclyn</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">9</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="left">tyler</td>
<td align="right">4</td>
<td align="right">7</td>
<td align="right">10</td>
<td align="right">21</td>
</tr>
</tbody>
</table>
<p>mutate() is a function that creates a new variable in a data frame using the existing variables. In this case, it creates a variable called total that is the sum of the existing variables x, y, and z.</p>
<div id="remove-a-column-using-the-select-function" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Remove a column using the select() function</h3>
<p>Adding a minus sign to the name of a variable within the <code>select()</code> command will remove that variable, leaving all of the others.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">my_data_frame &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="st">  </span>my_data_frame <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb73-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>total)</a>
<a class="sourceLine" id="cb73-4" data-line-number="4"></a>
<a class="sourceLine" id="cb73-5" data-line-number="5"><span class="kw">kable</span>(my_data_frame)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">n</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">russ</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">7</td>
</tr>
<tr class="even">
<td align="left">lucy</td>
<td align="right">2</td>
<td align="right">5</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">jaclyn</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">tyler</td>
<td align="right">4</td>
<td align="right">7</td>
<td align="right">10</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="tidyverse-in-action" class="section level2">
<h2><span class="header-section-number">2.3</span> Tidyverse in action</h2>
<p>To see the tidyverse in action, let’s clean up the NHANES dataset. Each individual in the NHANES dataset has a unique identifier stored in the variable <code>ID</code>. First let’s look at the number of rows in the dataset:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="kw">nrow</span>(NHANES)</a></code></pre></div>
<pre><code>## [1] 10000</code></pre>
<p>Now let’s see how many unique IDs there are. The <code>unique()</code> function returns a vector containing all of the unique values for a particular variable, and the <code>length()</code> function returns the length of the resulting vector.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">length</span>(<span class="kw">unique</span>(NHANES<span class="op">$</span>ID))</a></code></pre></div>
<pre><code>## [1] 6779</code></pre>
<p>This shows us that while there are 10,000 observations in the data frame, there are only 6779 unique IDs. This means that if we were to use the entire dataset, we would be reusing data from some individuals, which could give us incorrect results. For this reason, we wold like to discard any observations that are duplicated.</p>
<p>Let’s create a new variable called <code>NHANES_unique</code> that will contain only the distinct observations, with no individuals appearing more than once. The <code>dplyr</code> library provides a function called <code>distinct()</code> that will do this for us. You may notice that we didn’t explicitly load the <code>dplyr</code> library above; however, if you look at the messages that appeared when we loaded the <code>tidyverse</code> library, you will see that it loaded <code>dplyr</code> for us. To create the new data frame with unique observations, we will pipe the NHANES data frame into the <code>distinct()</code> function and then save the output to our new variable.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1">NHANES_unique &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb78-2" data-line-number="2"><span class="st">  </span>NHANES <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-3" data-line-number="3"><span class="st">  </span><span class="kw">distinct</span>(ID, <span class="dt">.keep_all =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>If we number of rows in the new data frame, it should be the same as the number of unique IDs (6779):</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw">nrow</span>(NHANES_unique)</a></code></pre></div>
<pre><code>## [1] 6779</code></pre>
<p>In the next example you will see the power of pipes come to life, when we start tying together multiple functions into a single operation (or “pipeline”).</p>
</div>
<div id="looking-at-individual-variables-using-pull-and-head" class="section level2">
<h2><span class="header-section-number">2.4</span> Looking at individual variables using pull() and head()</h2>
<p>The NHANES data frame contains a large number of variables, but usually we are only interested in a particular variable. We can extract a particular variable from a data frame using the <code>pull()</code> function. Let’s say that we want to extract the variable <code>PhysActive</code>. We could do this by piping the data frame into the pull command, which will result in a list of many thousands of values. Instead of printing out this entire list, we will pipe the result into the <code>head()</code> function, which just shows us the first few values contained in a variable. In this case we are not assigning the value back to a variable, so it will simply be printed to the screen.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1">NHANES <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="st">  </span><span class="co"># extract the PhysActive variable</span></a>
<a class="sourceLine" id="cb81-3" data-line-number="3"><span class="st">  </span><span class="kw">pull</span>(PhysActive) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-4" data-line-number="4"><span class="st">  </span><span class="co"># extract the first 10 values </span></a>
<a class="sourceLine" id="cb81-5" data-line-number="5"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-6" data-line-number="6"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">No</td>
</tr>
<tr class="odd">
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
</tr>
</tbody>
</table>
<p>There are two important things to notice here. The first is that there are three different values apparent in the answers: “Yes”, “No”, and <NA>, which means that the value is missing for this person (perhaps they didn’t want to answer that question on the survey). When we are working with data we generally need to remove missing values, as we will see below.</p>
<p>The second thing to notice is that R prints out a list of “Levels” of the variable. This is because this variable is defined as a particular kind of variable in R known as a <em>factor</em>. You can think of a factor variable as a categorial variable with a specific set of levels. The missing data are not treated as a level, so it can be useful to make the missing values explicit, which can be done using a function called <code>fct_explicit_na()</code> in the <code>forcats</code> package. Let’s add a line to do that:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">NHANES <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PhysActive =</span> <span class="kw">fct_explicit_na</span>(PhysActive)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="st">  </span><span class="co"># extract the PhysActive variable</span></a>
<a class="sourceLine" id="cb82-4" data-line-number="4"><span class="st">  </span><span class="kw">pull</span>(PhysActive) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-5" data-line-number="5"><span class="st">  </span><span class="co"># extract the first 10 values </span></a>
<a class="sourceLine" id="cb82-6" data-line-number="6"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-7" data-line-number="7"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">No</td>
</tr>
<tr class="odd">
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">(Missing)</td>
</tr>
<tr class="odd">
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">(Missing)</td>
</tr>
<tr class="odd">
<td align="left">(Missing)</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
</tr>
</tbody>
</table>
<p>This new line overwrote the old value of <code>PhysActive</code> with a version that has been processed by the <code>fct_explicit_na()</code> function to convert <NA> values to explicitly missing values. Now you can see that Missing values are treated as an explicit level, which will be useful later.</p>
<p>Now we are ready to start summarizing data!</p>
</div>
<div id="computing-a-frequency-distribution-section-reffrequency-distributions" class="section level2">
<h2><span class="header-section-number">2.5</span> Computing a frequency distribution (Section <a href="#frequency-distributions"><strong>??</strong></a>)</h2>
<p>We would like to compute a frequency distribution showing how many people report being either active or inactive. The following statement is fairly complex so we will step through it one bit at a time.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">PhysActive_table &lt;-<span class="st"> </span>NHANES_unique <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="st">  </span><span class="co"># convert the implicit missing values to explicit</span></a>
<a class="sourceLine" id="cb83-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PhysActive =</span> <span class="kw">fct_explicit_na</span>(PhysActive)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb83-4" data-line-number="4"><span class="st">  </span><span class="co"># select the variable of interest</span></a>
<a class="sourceLine" id="cb83-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(PhysActive) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-6" data-line-number="6"><span class="st">  </span><span class="co"># group by values of the variable</span></a>
<a class="sourceLine" id="cb83-7" data-line-number="7"><span class="st">  </span><span class="kw">group_by</span>(PhysActive) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-8" data-line-number="8"><span class="st">  </span><span class="co"># count the values</span></a>
<a class="sourceLine" id="cb83-9" data-line-number="9"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">AbsoluteFrequency =</span> <span class="kw">n</span>()) </a>
<a class="sourceLine" id="cb83-10" data-line-number="10"></a>
<a class="sourceLine" id="cb83-11" data-line-number="11"><span class="co"># kable() prints out the table in a prettier way.</span></a>
<a class="sourceLine" id="cb83-12" data-line-number="12"><span class="kw">kable</span>(PhysActive_table)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">PhysActive</th>
<th align="right">AbsoluteFrequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No</td>
<td align="right">2473</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="right">2972</td>
</tr>
<tr class="odd">
<td align="left">(Missing)</td>
<td align="right">1334</td>
</tr>
</tbody>
</table>
<p>This data frame still contains all of the original variables. Since we are only interested in the <code>PhysActive</code> variable, let’s extract that one and get rid of the rest. We can do this using the <code>select()</code> command from the <code>dplyr</code> package. Because there is also another select command available in R, we need to explicitly refer to the one from the <code>dplyr</code> package, which we do by including the package name followed by two colons: <code>dplyr::select()</code>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">NHANES_unique <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="st">  </span><span class="co"># convert the implicit missing values to explicit</span></a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PhysActive =</span> <span class="kw">fct_explicit_na</span>(PhysActive)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb84-4" data-line-number="4"><span class="st">  </span><span class="co"># select the variable of interest</span></a>
<a class="sourceLine" id="cb84-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(PhysActive) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb84-6" data-line-number="6"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb84-7" data-line-number="7"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">PhysActive</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">(Missing)</td>
</tr>
<tr class="odd">
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">(Missing)</td>
</tr>
<tr class="odd">
<td align="left">(Missing)</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">(Missing)</td>
</tr>
</tbody>
</table>
<p>The next function, <code>group_by()</code> tells R that we are going to want to analyze the data separate according to the different levels of the <code>PhysActive</code> variable:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" data-line-number="1">NHANES_unique <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-2" data-line-number="2"><span class="st">  </span><span class="co"># convert the implicit missing values to explicit</span></a>
<a class="sourceLine" id="cb85-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PhysActive =</span> <span class="kw">fct_explicit_na</span>(PhysActive)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-4" data-line-number="4"><span class="st">  </span><span class="co"># select the variable of interest</span></a>
<a class="sourceLine" id="cb85-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(PhysActive) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb85-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(PhysActive) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-7" data-line-number="7"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-8" data-line-number="8"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">PhysActive</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">(Missing)</td>
</tr>
<tr class="odd">
<td align="left">No</td>
</tr>
<tr class="even">
<td align="left">(Missing)</td>
</tr>
<tr class="odd">
<td align="left">(Missing)</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
</tr>
<tr class="odd">
<td align="left">Yes</td>
</tr>
<tr class="even">
<td align="left">(Missing)</td>
</tr>
</tbody>
</table>
<p>The final command tells R to create a new data frame by summarizing the data that we are passing in (which in this case is the PhysActive variable, grouped by its different levels). We tell the <code>summarize()</code> function to create a new variable (called <code>AbsoluteFrequency</code>) will contain a count of the number of observations for each group, which is generated by the <code>n()</code> function.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">NHANES_unique <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-2" data-line-number="2"><span class="st">  </span><span class="co"># convert the implicit missing values to explicit</span></a>
<a class="sourceLine" id="cb86-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">PhysActive =</span> <span class="kw">fct_explicit_na</span>(PhysActive)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-4" data-line-number="4"><span class="st">  </span><span class="co"># select the variable of interest</span></a>
<a class="sourceLine" id="cb86-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(PhysActive) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb86-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(PhysActive) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-7" data-line-number="7"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">AbsoluteFrequency =</span> <span class="kw">n</span>())  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb86-8" data-line-number="8"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">PhysActive</th>
<th align="right">AbsoluteFrequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No</td>
<td align="right">2473</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="right">2972</td>
</tr>
<tr class="odd">
<td align="left">(Missing)</td>
<td align="right">1334</td>
</tr>
</tbody>
</table>
<p>Now let’s say we want to add another column with percentage of observations in each group. We compute the percentage by dividing the absolute frequency for each group by the total number. We can use the table that we already generated, and add a new variable, again using <code>mutate()</code>:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1">PhysActive_table &lt;-<span class="st"> </span>PhysActive_table <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb87-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb87-3" data-line-number="3">    <span class="dt">Percentage =</span> AbsoluteFrequency <span class="op">/</span><span class="st"> </span></a>
<a class="sourceLine" id="cb87-4" data-line-number="4"><span class="st">      </span><span class="kw">sum</span>(AbsoluteFrequency) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb87-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb87-6" data-line-number="6"></a>
<a class="sourceLine" id="cb87-7" data-line-number="7"><span class="kw">kable</span>(PhysActive_table, <span class="dt">digits=</span><span class="dv">2</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">PhysActive</th>
<th align="right">AbsoluteFrequency</th>
<th align="right">Percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">No</td>
<td align="right">2473</td>
<td align="right">36.48</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="right">2972</td>
<td align="right">43.84</td>
</tr>
<tr class="odd">
<td align="left">(Missing)</td>
<td align="right">1334</td>
<td align="right">19.68</td>
</tr>
</tbody>
</table>
</div>
<div id="computing-a-cumulative-distribution-section-refcumulative-distributions" class="section level2">
<h2><span class="header-section-number">2.6</span> Computing a cumulative distribution (Section <a href="#cumulative-distributions"><strong>??</strong></a>)</h2>
<p>Let’s compute a cumulative distribution for the <code>SleepHrsNight</code> variable in NHANES. This looks very similar to what we saw in the previous section.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="co"># create summary table for relative frequency of different</span></a>
<a class="sourceLine" id="cb88-2" data-line-number="2"><span class="co"># values of SleepHrsNight </span></a>
<a class="sourceLine" id="cb88-3" data-line-number="3"></a>
<a class="sourceLine" id="cb88-4" data-line-number="4">SleepHrsNight_cumulative &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb88-5" data-line-number="5"><span class="st">  </span>NHANES_unique <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-6" data-line-number="6"><span class="st">  </span><span class="co"># drop NA values for SleepHrsNight variable</span></a>
<a class="sourceLine" id="cb88-7" data-line-number="7"><span class="st">  </span><span class="kw">drop_na</span>(SleepHrsNight) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-8" data-line-number="8"><span class="st">  </span><span class="co"># remove other variables</span></a>
<a class="sourceLine" id="cb88-9" data-line-number="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(SleepHrsNight) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-10" data-line-number="10"><span class="st">  </span><span class="co"># group by values</span></a>
<a class="sourceLine" id="cb88-11" data-line-number="11"><span class="st">  </span><span class="kw">group_by</span>(SleepHrsNight) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-12" data-line-number="12"><span class="st">  </span><span class="co"># create summary table</span></a>
<a class="sourceLine" id="cb88-13" data-line-number="13"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">AbsoluteFrequency =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-14" data-line-number="14"><span class="st">  </span><span class="co"># create relative and cumulative frequencies</span></a>
<a class="sourceLine" id="cb88-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb88-16" data-line-number="16">    <span class="dt">RelativeFrequency =</span> AbsoluteFrequency <span class="op">/</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-17" data-line-number="17"><span class="st">      </span><span class="kw">sum</span>(AbsoluteFrequency),</a>
<a class="sourceLine" id="cb88-18" data-line-number="18">    <span class="dt">CumulativeDensity =</span> <span class="kw">cumsum</span>(RelativeFrequency)</a>
<a class="sourceLine" id="cb88-19" data-line-number="19">  )</a>
<a class="sourceLine" id="cb88-20" data-line-number="20"></a>
<a class="sourceLine" id="cb88-21" data-line-number="21"><span class="kw">kable</span>(SleepHrsNight_cumulative)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">SleepHrsNight</th>
<th align="right">AbsoluteFrequency</th>
<th align="right">RelativeFrequency</th>
<th align="right">CumulativeDensity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2</td>
<td align="right">9</td>
<td align="right">0.0017875</td>
<td align="right">0.0017875</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">49</td>
<td align="right">0.0097319</td>
<td align="right">0.0115194</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">200</td>
<td align="right">0.0397219</td>
<td align="right">0.0512413</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">406</td>
<td align="right">0.0806356</td>
<td align="right">0.1318769</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1172</td>
<td align="right">0.2327706</td>
<td align="right">0.3646475</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1394</td>
<td align="right">0.2768620</td>
<td align="right">0.6415094</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1405</td>
<td align="right">0.2790467</td>
<td align="right">0.9205561</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">271</td>
<td align="right">0.0538232</td>
<td align="right">0.9743793</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">97</td>
<td align="right">0.0192651</td>
<td align="right">0.9936445</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">15</td>
<td align="right">0.0029791</td>
<td align="right">0.9966236</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">17</td>
<td align="right">0.0033764</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
</div>
<div id="data-cleaning-and-tidying-with-r" class="section level2">
<h2><span class="header-section-number">2.7</span> Data cleaning and tidying with R</h2>
<p>Now that you know a bit about the tidyverse, let’s look at the various tools that it provides for working with data. We will use as an example an analysis of whether attitudes about statistics are different between the different student year groups in the class.</p>
<div id="statistics-attitude-data-from-course-survey" class="section level3">
<h3><span class="header-section-number">2.7.1</span> Statistics attitude data from course survey</h3>
<p>These data were collected using the Attitudes Towards Statistics (ATS) scale (from <a href="https://www.stat.auckland.ac.nz/~iase/cblumberg/wise2.pdf" class="uri">https://www.stat.auckland.ac.nz/~iase/cblumberg/wise2.pdf</a>).</p>
<p>The 29-item ATS has two subscales. The Attitudes Toward Field subscale consists of the following 20 items, with reverse-keyed items indicated by an “(R)”:
1, 3, 5, 6(R), 9, 10(R), 11, 13, 14(R), 16(R), 17, 19, 20(R), 21, 22, 23, 24, 26, 28(R), 29</p>
<p>The Attitudes Toward Course subscale consists of the following 9 items:
2(R), 4(R), 7(R), 8, 12(R), 15(R), 18(R), 25(R), 27(R)</p>
<p>For our purposes, we will just combine all 29 items together, rather than separating them into these subscales.</p>
<p>Note: I have removed the data from the graduate students and 5+ year students, since those would be too easily identifiable given how few there are.</p>
<p>Let’s first create a variable containing the file path to the data.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">attitudeData_file &lt;-<span class="st"> &#39;data/statsAttitude.txt&#39;</span></a></code></pre></div>
<p>Next, let’s load the data from the file using the tidyverse function <code>read_tsv()</code>. There are several functions available for reading in different file formats as part of the the <code>readr</code> tidyverse package.</p>
<p>Right now the variable names are unwieldy, since they include the entire name of the item; this is how Google Forms stores the data. Let’s change the variable names to be somewhat more readable. We will change the names to “ats<X>” where <X> is replaced with the question number and ats indicates Attitudes Toward Statistics scale. We can create these names using the <code>rename()</code> and <code>paste0()</code> functions. <code>rename()</code> is pretty self-explanatory: a new name is assigned to an old name or a column position. The <code>paste0()</code> function takes a string along with a set of numbers, and creates a vector that combines the string with the number.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1">nQuestions &lt;-<span class="st"> </span><span class="dv">29</span> <span class="co"># other than the first two columns, </span></a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="co"># the rest of the columns are for the 29 questions in the statistics</span></a>
<a class="sourceLine" id="cb90-3" data-line-number="3"><span class="co"># attitude survey; we&#39;ll use this below to rename these columns </span></a>
<a class="sourceLine" id="cb90-4" data-line-number="4"><span class="co"># based on their question number</span></a>
<a class="sourceLine" id="cb90-5" data-line-number="5"></a>
<a class="sourceLine" id="cb90-6" data-line-number="6"><span class="co"># use rename to change the first two column names</span></a>
<a class="sourceLine" id="cb90-7" data-line-number="7"><span class="co"># rename can refer to columns either by their number or their name</span></a>
<a class="sourceLine" id="cb90-8" data-line-number="8">attitudeData &lt;-</a>
<a class="sourceLine" id="cb90-9" data-line-number="9"><span class="st">  </span>attitudeData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb90-10" data-line-number="10"><span class="st">  </span><span class="kw">rename</span>(     <span class="co"># rename using columm numbers</span></a>
<a class="sourceLine" id="cb90-11" data-line-number="11">    <span class="co"># The first column is the year </span></a>
<a class="sourceLine" id="cb90-12" data-line-number="12">    <span class="dt">Year =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb90-13" data-line-number="13">    <span class="co"># The second column indicates </span></a>
<a class="sourceLine" id="cb90-14" data-line-number="14">    <span class="co"># whether the person took stats before</span></a>
<a class="sourceLine" id="cb90-15" data-line-number="15">    <span class="dt">StatsBefore =</span> <span class="dv">2</span> </a>
<a class="sourceLine" id="cb90-16" data-line-number="16">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb90-17" data-line-number="17"><span class="st">  </span><span class="kw">rename_at</span>( </a>
<a class="sourceLine" id="cb90-18" data-line-number="18">    <span class="co"># rename all the columns except Year and StatsBefore</span></a>
<a class="sourceLine" id="cb90-19" data-line-number="19">    <span class="kw">vars</span>(<span class="op">-</span>Year, <span class="op">-</span>StatsBefore), </a>
<a class="sourceLine" id="cb90-20" data-line-number="20">    <span class="co">#rename by pasting the word &quot;stat&quot; and the number</span></a>
<a class="sourceLine" id="cb90-21" data-line-number="21">    <span class="kw">list</span>(<span class="dt">name =</span> <span class="op">~</span><span class="kw">paste0</span>(<span class="st">&#39;ats&#39;</span>, <span class="dv">1</span><span class="op">:</span>nQuestions)) </a>
<a class="sourceLine" id="cb90-22" data-line-number="22">  )</a>
<a class="sourceLine" id="cb90-23" data-line-number="23"></a>
<a class="sourceLine" id="cb90-24" data-line-number="24"><span class="co"># print out the column names</span></a>
<a class="sourceLine" id="cb90-25" data-line-number="25"><span class="kw">names</span>(attitudeData)</a></code></pre></div>
<pre><code>##  [1] &quot;Year&quot;        &quot;StatsBefore&quot; &quot;ats1&quot;        &quot;ats2&quot;        &quot;ats3&quot;       
##  [6] &quot;ats4&quot;        &quot;ats5&quot;        &quot;ats6&quot;        &quot;ats7&quot;        &quot;ats8&quot;       
## [11] &quot;ats9&quot;        &quot;ats10&quot;       &quot;ats11&quot;       &quot;ats12&quot;       &quot;ats13&quot;      
## [16] &quot;ats14&quot;       &quot;ats15&quot;       &quot;ats16&quot;       &quot;ats17&quot;       &quot;ats18&quot;      
## [21] &quot;ats19&quot;       &quot;ats20&quot;       &quot;ats21&quot;       &quot;ats22&quot;       &quot;ats23&quot;      
## [26] &quot;ats24&quot;       &quot;ats25&quot;       &quot;ats26&quot;       &quot;ats27&quot;       &quot;ats28&quot;      
## [31] &quot;ats29&quot;</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1"><span class="co">#check out the data again</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2"><span class="kw">glimpse</span>(attitudeData)</a></code></pre></div>
<pre><code>## Observations: 148
## Variables: 31
## $ Year        &lt;dbl&gt; 3, 4, 2, 1, 2, 3, 4, 2, 2, 2, 4, 2, 3…
## $ StatsBefore &lt;chr&gt; &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;,…
## $ ats1        &lt;dbl&gt; 6, 4, 6, 3, 7, 4, 6, 5, 7, 5, 5, 4, 2…
## $ ats2        &lt;dbl&gt; 1, 5, 5, 2, 7, 5, 5, 4, 2, 2, 3, 3, 7…
## $ ats3        &lt;dbl&gt; 7, 6, 5, 7, 2, 4, 7, 7, 7, 5, 6, 5, 7…
## $ ats4        &lt;dbl&gt; 2, 5, 5, 2, 7, 3, 3, 4, 5, 3, 3, 2, 3…
## $ ats5        &lt;dbl&gt; 7, 5, 6, 7, 5, 4, 6, 6, 7, 5, 3, 5, 4…
## $ ats6        &lt;dbl&gt; 1, 4, 5, 2, 2, 4, 2, 3, 1, 2, 2, 3, 1…
## $ ats7        &lt;dbl&gt; 1, 4, 3, 2, 4, 4, 2, 2, 3, 2, 4, 2, 4…
## $ ats8        &lt;dbl&gt; 2, 1, 4, 3, 1, 4, 4, 4, 7, 3, 2, 4, 1…
## $ ats9        &lt;dbl&gt; 5, 4, 5, 5, 7, 4, 5, 5, 7, 6, 3, 5, 5…
## $ ats10       &lt;dbl&gt; 2, 3, 2, 2, 1, 4, 2, 2, 1, 3, 3, 1, 1…
## $ ats11       &lt;dbl&gt; 6, 4, 6, 2, 7, 4, 6, 5, 7, 3, 3, 4, 2…
## $ ats12       &lt;dbl&gt; 2, 4, 1, 2, 5, 7, 2, 1, 2, 4, 4, 2, 4…
## $ ats13       &lt;dbl&gt; 6, 4, 5, 5, 7, 3, 6, 6, 7, 5, 2, 5, 1…
## $ ats14       &lt;dbl&gt; 2, 4, 3, 3, 3, 4, 2, 1, 1, 3, 3, 2, 1…
## $ ats15       &lt;dbl&gt; 2, 4, 3, 3, 5, 6, 3, 4, 2, 3, 2, 4, 3…
## $ ats16       &lt;dbl&gt; 1, 3, 2, 5, 1, 5, 2, 1, 2, 3, 2, 2, 1…
## $ ats17       &lt;dbl&gt; 7, 7, 5, 7, 7, 4, 6, 6, 7, 6, 6, 7, 4…
## $ ats18       &lt;dbl&gt; 2, 5, 4, 5, 7, 4, 2, 4, 2, 5, 2, 4, 6…
## $ ats19       &lt;dbl&gt; 3, 3, 4, 3, 2, 3, 6, 5, 7, 3, 3, 5, 2…
## $ ats20       &lt;dbl&gt; 1, 4, 1, 2, 1, 4, 2, 2, 1, 2, 3, 2, 3…
## $ ats21       &lt;dbl&gt; 6, 3, 5, 5, 7, 5, 6, 5, 7, 3, 4, 6, 6…
## $ ats22       &lt;dbl&gt; 7, 4, 5, 6, 7, 5, 6, 5, 7, 5, 5, 5, 5…
## $ ats23       &lt;dbl&gt; 6, 4, 6, 6, 7, 5, 6, 7, 7, 5, 3, 5, 3…
## $ ats24       &lt;dbl&gt; 7, 4, 4, 6, 7, 5, 6, 5, 7, 5, 5, 5, 3…
## $ ats25       &lt;dbl&gt; 3, 5, 3, 3, 5, 4, 3, 4, 2, 3, 3, 2, 5…
## $ ats26       &lt;dbl&gt; 7, 4, 5, 6, 2, 4, 6, 5, 7, 3, 4, 4, 2…
## $ ats27       &lt;dbl&gt; 2, 4, 2, 2, 4, 4, 2, 1, 2, 3, 3, 2, 1…
## $ ats28       &lt;dbl&gt; 2, 4, 3, 5, 2, 3, 3, 1, 1, 4, 3, 2, 2…
## $ ats29       &lt;dbl&gt; 4, 4, 3, 6, 2, 1, 5, 3, 3, 3, 2, 3, 2…</code></pre>
<p>The next thing we need to do is to create an ID for each individual. To do this, we will use the <code>rownames_to_column()</code> function from the tidyverse. This creates a new variable (which we name “ID”) that contains the row names from the data frame; thsee are simply the numbers 1 to N.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1"><span class="co"># let&#39;s add a participant ID so that we will be able to </span></a>
<a class="sourceLine" id="cb94-2" data-line-number="2"><span class="co"># identify them later</span></a>
<a class="sourceLine" id="cb94-3" data-line-number="3">attitudeData &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb94-4" data-line-number="4"><span class="st">  </span>attitudeData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-5" data-line-number="5"><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&#39;ID&#39;</span>)</a>
<a class="sourceLine" id="cb94-6" data-line-number="6"></a>
<a class="sourceLine" id="cb94-7" data-line-number="7"><span class="kw">head</span>(attitudeData)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 32
##   ID     Year StatsBefore  ats1  ats2  ats3  ats4  ats5
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 1         3 Yes             6     1     7     2     7
## 2 2         4 No              4     5     6     5     5
## 3 3         2 No              6     5     5     5     6
## 4 4         1 Yes             3     2     7     2     7
## 5 5         2 No              7     7     2     7     5
## 6 6         3 No              4     5     4     3     4
## # … with 24 more variables: ats6 &lt;dbl&gt;, ats7 &lt;dbl&gt;,
## #   ats8 &lt;dbl&gt;, ats9 &lt;dbl&gt;, ats10 &lt;dbl&gt;, ats11 &lt;dbl&gt;,
## #   ats12 &lt;dbl&gt;, ats13 &lt;dbl&gt;, ats14 &lt;dbl&gt;, ats15 &lt;dbl&gt;,
## #   ats16 &lt;dbl&gt;, ats17 &lt;dbl&gt;, ats18 &lt;dbl&gt;, ats19 &lt;dbl&gt;,
## #   ats20 &lt;dbl&gt;, ats21 &lt;dbl&gt;, ats22 &lt;dbl&gt;, ats23 &lt;dbl&gt;,
## #   ats24 &lt;dbl&gt;, ats25 &lt;dbl&gt;, ats26 &lt;dbl&gt;, ats27 &lt;dbl&gt;,
## #   ats28 &lt;dbl&gt;, ats29 &lt;dbl&gt;</code></pre>
<p>If you look closely at the data, you can see that some of the participants have some missing responses. We can count them up for each individual and create a new variable to store this to a new variable called <code>numNA</code> using <code>mutate()</code>.</p>
<p>We can also create a table showing how many participants have a particular number of NA values. Here we use two additional commands that you haven’t seen yet. The <code>group_by()</code> function tells other functions to do their analyses while breaking the data into groups based on one of the variables. Here we are going to want to summarize the number of people with each possible number of NAs, so we will group responses by the numNA variable that we are creating in the first command here.</p>
<p>The summarize() function creates a summary of the data, with the new variables based on the data being fed in. In this case, we just want to count up the number of subjects in each group, which we can do using the special n() function from dpylr.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="co"># compute the number of NAs for each participant</span></a>
<a class="sourceLine" id="cb96-2" data-line-number="2">attitudeData &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb96-3" data-line-number="3"><span class="st">  </span>attitudeData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb96-5" data-line-number="5">    <span class="co"># we use the . symbol to tell the is.na function </span></a>
<a class="sourceLine" id="cb96-6" data-line-number="6">    <span class="co"># to look at the entire data frame</span></a>
<a class="sourceLine" id="cb96-7" data-line-number="7">    <span class="dt">numNA =</span> <span class="kw">rowSums</span>(<span class="kw">is.na</span>(.)) </a>
<a class="sourceLine" id="cb96-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb96-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb96-10" data-line-number="10"><span class="co"># present a table with counts of the number of missing responses</span></a>
<a class="sourceLine" id="cb96-11" data-line-number="11">attitudeData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-12" data-line-number="12"><span class="st">  </span><span class="kw">count</span>(numNA)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   numNA     n
##   &lt;dbl&gt; &lt;int&gt;
## 1     0   141
## 2     1     6
## 3     2     1</code></pre>
<p>We can see from the table that there are only a few participants with missing data; six people are missing one answer, and one is missing two answers. Let’s find those individuals, using the filter() command from dplyr. filter() returns the subset of rows from a data frame that match a particular test - in this case, whether numNA is &gt; 0.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">attitudeData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb98-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(numNA <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## # A tibble: 7 x 33
##   ID     Year StatsBefore  ats1  ats2  ats3  ats4  ats5
##   &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 42        2 No             NA     2     7     5     6
## 2 55        1 No              5     3     7     4     5
## 3 90        1 No              7     2     7     5     7
## 4 113       2 No              5     7     7     5     6
## 5 117       2 Yes             6     6     7     4     6
## 6 137       3 No              7     5     6     5     6
## 7 139       1 No              7     5     7     5     6
## # … with 25 more variables: ats6 &lt;dbl&gt;, ats7 &lt;dbl&gt;,
## #   ats8 &lt;dbl&gt;, ats9 &lt;dbl&gt;, ats10 &lt;dbl&gt;, ats11 &lt;dbl&gt;,
## #   ats12 &lt;dbl&gt;, ats13 &lt;dbl&gt;, ats14 &lt;dbl&gt;, ats15 &lt;dbl&gt;,
## #   ats16 &lt;dbl&gt;, ats17 &lt;dbl&gt;, ats18 &lt;dbl&gt;, ats19 &lt;dbl&gt;,
## #   ats20 &lt;dbl&gt;, ats21 &lt;dbl&gt;, ats22 &lt;dbl&gt;, ats23 &lt;dbl&gt;,
## #   ats24 &lt;dbl&gt;, ats25 &lt;dbl&gt;, ats26 &lt;dbl&gt;, ats27 &lt;dbl&gt;,
## #   ats28 &lt;dbl&gt;, ats29 &lt;dbl&gt;, numNA &lt;dbl&gt;</code></pre>
<p>There are fancy techniques for trying to guess the value of missing data (known as “imputation”) but since the number of participants with missing values is small, let’s just drop those participants from the list. We can do this using the <code>drop_na()</code> function from the <code>tidyr</code> package, another tidyverse package that provides tools for cleaning data. We will also remove the numNA variable, since we won’t need it anymore after removing the subjects with missing answeres. We do this using the <code>select()</code> function from the <code>dplyr</code> tidyverse package, which selects or removes columns from a data frame. By putting a minus sign in front of numNA, we are telling it to remove that column.</p>
<p><code>select()</code> and <code>filter()</code> are similar - <code>select()</code> works on columns (i.e. variables) and <code>filter()</code> works on rows (i.e. observations).</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="co"># this is equivalent to drop_na(attitudeData)</span></a>
<a class="sourceLine" id="cb100-2" data-line-number="2">attitudeDataNoNA &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb100-3" data-line-number="3"><span class="st">  </span>attitudeData <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb100-4" data-line-number="4"><span class="st">  </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb100-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>numNA)</a></code></pre></div>
<p>Try the following on your own: Using the attitudeData data frame, drop the NA values, create a new variable called mystery that contains a value of 1 for anyone who answered 7 to question ats4 (“Statistics seems very mysterious to me”). Create a summary that includes the number of people reporting 7 on this question, and the proportion of people who reported 7.</p>
<div id="tidy-data" class="section level4">
<h4><span class="header-section-number">2.7.1.1</span> Tidy data</h4>
<p>These data are in a format that meets the principles of “tidy data”, which state the following:</p>
<ul>
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have its own cell.</li>
</ul>
<p>In our case, each column represents a variable: <code>ID</code> identifies which student responded, <code>Year</code> contains their year at Stanford, <code>StatsBefore</code> contains whether or not they have taken statistics before, and ats1 through ats29 contain their responses to each item on the ATS scale. Each observation (row) is a response from one individual student. Each value has its own cell (e.g., the values for <code>Year</code> and <code>StatsBefoe</code> are stored in separate cells in separate columns).</p>
<p>For an example of data that are NOT tidy, take a look at these data <a href="http://www.pewforum.org/religious-landscape-study/belief-in-hell/#generational-cohort">Belief in Hell</a> - click on the “Table” tab to see the data.</p>
<ul>
<li>What are the variables</li>
<li>Why aren’t these data tidy?</li>
</ul>
</div>
<div id="recoding-data" class="section level4">
<h4><span class="header-section-number">2.7.1.2</span> Recoding data</h4>
<p>We now have tidy data; however, some of the ATS items require recoding. Specifically, some of the items need to be “reverse coded”; these items include: ats2, ats4, ats6, ats7, ats10, ats12, ats14, ats15, ats16, ats18, ats20, ats25, ats27 and ats28. The raw responses for each item are on the 1-7 scale; therefore, for the reverse coded items, we need to reverse them by subtracting the raw score from 8 (such that 7 becomes 1 and 1 becomes 7). To recode these items, we will use the tidyverse <code>mutate()</code> function. It’s a good idea when recoding to preserve the raw original variables and create new recoded variables with different names.</p>
<p>There are two ways we can use <code>mutate()</code> function to recode these variables. The first way is easier to understand as a new code, but less efficient and more prone to error. Specifically, we repeat the same code for every variable we want to reverse code as follows:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1">attitudeDataNoNA <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb101-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb101-3" data-line-number="3">    <span class="dt">ats2_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats2,</a>
<a class="sourceLine" id="cb101-4" data-line-number="4">    <span class="dt">ats4_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats4,</a>
<a class="sourceLine" id="cb101-5" data-line-number="5">    <span class="dt">ats6_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats6,</a>
<a class="sourceLine" id="cb101-6" data-line-number="6">    <span class="dt">ats7_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats7,</a>
<a class="sourceLine" id="cb101-7" data-line-number="7">    <span class="dt">ats10_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats10,</a>
<a class="sourceLine" id="cb101-8" data-line-number="8">    <span class="dt">ats12_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats12,</a>
<a class="sourceLine" id="cb101-9" data-line-number="9">    <span class="dt">ats14_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats14,</a>
<a class="sourceLine" id="cb101-10" data-line-number="10">    <span class="dt">ats15_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats15,</a>
<a class="sourceLine" id="cb101-11" data-line-number="11">    <span class="dt">ats16_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats16,</a>
<a class="sourceLine" id="cb101-12" data-line-number="12">    <span class="dt">ats18_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats18,</a>
<a class="sourceLine" id="cb101-13" data-line-number="13">    <span class="dt">ats20_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats20,</a>
<a class="sourceLine" id="cb101-14" data-line-number="14">    <span class="dt">ats25_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats25,</a>
<a class="sourceLine" id="cb101-15" data-line-number="15">    <span class="dt">ats27_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats27,</a>
<a class="sourceLine" id="cb101-16" data-line-number="16">    <span class="dt">ats28_re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>ats28</a>
<a class="sourceLine" id="cb101-17" data-line-number="17">  ) </a></code></pre></div>
<pre><code>## # A tibble: 141 x 46
##    ID     Year StatsBefore  ats1  ats2  ats3  ats4  ats5
##    &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 1         3 Yes             6     1     7     2     7
##  2 2         4 No              4     5     6     5     5
##  3 3         2 No              6     5     5     5     6
##  4 4         1 Yes             3     2     7     2     7
##  5 5         2 No              7     7     2     7     5
##  6 6         3 No              4     5     4     3     4
##  7 7         4 Yes             6     5     7     3     6
##  8 8         2 Yes             5     4     7     4     6
##  9 9         2 Yes             7     2     7     5     7
## 10 10        2 Yes             5     2     5     3     5
## # … with 131 more rows, and 38 more variables: ats6 &lt;dbl&gt;,
## #   ats7 &lt;dbl&gt;, ats8 &lt;dbl&gt;, ats9 &lt;dbl&gt;, ats10 &lt;dbl&gt;,
## #   ats11 &lt;dbl&gt;, ats12 &lt;dbl&gt;, ats13 &lt;dbl&gt;, ats14 &lt;dbl&gt;,
## #   ats15 &lt;dbl&gt;, ats16 &lt;dbl&gt;, ats17 &lt;dbl&gt;, ats18 &lt;dbl&gt;,
## #   ats19 &lt;dbl&gt;, ats20 &lt;dbl&gt;, ats21 &lt;dbl&gt;, ats22 &lt;dbl&gt;,
## #   ats23 &lt;dbl&gt;, ats24 &lt;dbl&gt;, ats25 &lt;dbl&gt;, ats26 &lt;dbl&gt;,
## #   ats27 &lt;dbl&gt;, ats28 &lt;dbl&gt;, ats29 &lt;dbl&gt;, ats2_re &lt;dbl&gt;,
## #   ats4_re &lt;dbl&gt;, ats6_re &lt;dbl&gt;, ats7_re &lt;dbl&gt;,
## #   ats10_re &lt;dbl&gt;, ats12_re &lt;dbl&gt;, ats14_re &lt;dbl&gt;,
## #   ats15_re &lt;dbl&gt;, ats16_re &lt;dbl&gt;, ats18_re &lt;dbl&gt;,
## #   ats20_re &lt;dbl&gt;, ats25_re &lt;dbl&gt;, ats27_re &lt;dbl&gt;,
## #   ats28_re &lt;dbl&gt;</code></pre>
<p>The second way is more efficient and takes advatange of the use of “scoped verbs” (<a href="https://dplyr.tidyverse.org/reference/scoped.html" class="uri">https://dplyr.tidyverse.org/reference/scoped.html</a>), which allow you to apply the same code to several variables at once. Because you don’t have to keep repeating the same code, you’re less likely to make an error:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1"><span class="co">#create a vector of the names of the variables to recode</span></a>
<a class="sourceLine" id="cb103-2" data-line-number="2">ats_recode &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb103-3" data-line-number="3"><span class="st">  </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb103-4" data-line-number="4">    <span class="st">&quot;ats2&quot;</span>,</a>
<a class="sourceLine" id="cb103-5" data-line-number="5">    <span class="st">&quot;ats4&quot;</span>,</a>
<a class="sourceLine" id="cb103-6" data-line-number="6">    <span class="st">&quot;ats6&quot;</span>,</a>
<a class="sourceLine" id="cb103-7" data-line-number="7">    <span class="st">&quot;ats7&quot;</span>,</a>
<a class="sourceLine" id="cb103-8" data-line-number="8">    <span class="st">&quot;ats10&quot;</span>,</a>
<a class="sourceLine" id="cb103-9" data-line-number="9">    <span class="st">&quot;ats12&quot;</span>,</a>
<a class="sourceLine" id="cb103-10" data-line-number="10">    <span class="st">&quot;ats14&quot;</span>,</a>
<a class="sourceLine" id="cb103-11" data-line-number="11">    <span class="st">&quot;ats15&quot;</span>,</a>
<a class="sourceLine" id="cb103-12" data-line-number="12">    <span class="st">&quot;ats16&quot;</span>,</a>
<a class="sourceLine" id="cb103-13" data-line-number="13">    <span class="st">&quot;ats18&quot;</span>,</a>
<a class="sourceLine" id="cb103-14" data-line-number="14">    <span class="st">&quot;ats20&quot;</span>,</a>
<a class="sourceLine" id="cb103-15" data-line-number="15">    <span class="st">&quot;ats25&quot;</span>,</a>
<a class="sourceLine" id="cb103-16" data-line-number="16">    <span class="st">&quot;ats27&quot;</span>,</a>
<a class="sourceLine" id="cb103-17" data-line-number="17">    <span class="st">&quot;ats28&quot;</span></a>
<a class="sourceLine" id="cb103-18" data-line-number="18">  )</a>
<a class="sourceLine" id="cb103-19" data-line-number="19"></a>
<a class="sourceLine" id="cb103-20" data-line-number="20"></a>
<a class="sourceLine" id="cb103-21" data-line-number="21">attitudeDataNoNA &lt;-</a>
<a class="sourceLine" id="cb103-22" data-line-number="22"><span class="st">  </span>attitudeDataNoNA <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb103-23" data-line-number="23"><span class="st">  </span><span class="kw">mutate_at</span>(</a>
<a class="sourceLine" id="cb103-24" data-line-number="24">    <span class="kw">vars</span>(ats_recode), <span class="co"># the variables you want to recode</span></a>
<a class="sourceLine" id="cb103-25" data-line-number="25">    <span class="kw">funs</span>(<span class="dt">re =</span> <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>.) <span class="co"># the function to apply to each variable</span></a>
<a class="sourceLine" id="cb103-26" data-line-number="26">  )</a></code></pre></div>
<p>Whenever we do an operation like this, it’s good to check that it actually worked correctly. It’s easy to make mistakes in coding, which is why it’s important to check your work as well as you can.</p>
<p>We can quickly select a couple of the raw and recoded columns from our data and make sure things appear to have gone according to plan:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1">attitudeDataNoNA <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(</a>
<a class="sourceLine" id="cb104-3" data-line-number="3">    ats2,</a>
<a class="sourceLine" id="cb104-4" data-line-number="4">    ats2_re,</a>
<a class="sourceLine" id="cb104-5" data-line-number="5">    ats4,</a>
<a class="sourceLine" id="cb104-6" data-line-number="6">    ats4_re</a>
<a class="sourceLine" id="cb104-7" data-line-number="7">  )</a></code></pre></div>
<pre><code>## # A tibble: 141 x 4
##     ats2 ats2_re  ats4 ats4_re
##    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1     1       7     2       6
##  2     5       3     5       3
##  3     5       3     5       3
##  4     2       6     2       6
##  5     7       1     7       1
##  6     5       3     3       5
##  7     5       3     3       5
##  8     4       4     4       4
##  9     2       6     5       3
## 10     2       6     3       5
## # … with 131 more rows</code></pre>
<p>Let’s also make sure that there are no responses outside of the 1-7 scale that we expect, and make sure that no one specified a year outside of the 1-4 range.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1">attitudeDataNoNA <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb106-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise_at</span>(</a>
<a class="sourceLine" id="cb106-3" data-line-number="3">    <span class="kw">vars</span>(ats1<span class="op">:</span>ats28_re),</a>
<a class="sourceLine" id="cb106-4" data-line-number="4">    <span class="kw">funs</span>(min, max)</a>
<a class="sourceLine" id="cb106-5" data-line-number="5">  )</a></code></pre></div>
<pre><code>## # A tibble: 1 x 86
##   ats1_min ats2_min ats3_min ats4_min ats5_min ats6_min
##      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1        1        1        2        1        2        1
## # … with 80 more variables: ats7_min &lt;dbl&gt;, ats8_min &lt;dbl&gt;,
## #   ats9_min &lt;dbl&gt;, ats10_min &lt;dbl&gt;, ats11_min &lt;dbl&gt;,
## #   ats12_min &lt;dbl&gt;, ats13_min &lt;dbl&gt;, ats14_min &lt;dbl&gt;,
## #   ats15_min &lt;dbl&gt;, ats16_min &lt;dbl&gt;, ats17_min &lt;dbl&gt;,
## #   ats18_min &lt;dbl&gt;, ats19_min &lt;dbl&gt;, ats20_min &lt;dbl&gt;,
## #   ats21_min &lt;dbl&gt;, ats22_min &lt;dbl&gt;, ats23_min &lt;dbl&gt;,
## #   ats24_min &lt;dbl&gt;, ats25_min &lt;dbl&gt;, ats26_min &lt;dbl&gt;,
## #   ats27_min &lt;dbl&gt;, ats28_min &lt;dbl&gt;, ats29_min &lt;dbl&gt;,
## #   ats2_re_min &lt;dbl&gt;, ats4_re_min &lt;dbl&gt;,
## #   ats6_re_min &lt;dbl&gt;, ats7_re_min &lt;dbl&gt;,
## #   ats10_re_min &lt;dbl&gt;, ats12_re_min &lt;dbl&gt;,
## #   ats14_re_min &lt;dbl&gt;, ats15_re_min &lt;dbl&gt;,
## #   ats16_re_min &lt;dbl&gt;, ats18_re_min &lt;dbl&gt;,
## #   ats20_re_min &lt;dbl&gt;, ats25_re_min &lt;dbl&gt;,
## #   ats27_re_min &lt;dbl&gt;, ats28_re_min &lt;dbl&gt;, ats1_max &lt;dbl&gt;,
## #   ats2_max &lt;dbl&gt;, ats3_max &lt;dbl&gt;, ats4_max &lt;dbl&gt;,
## #   ats5_max &lt;dbl&gt;, ats6_max &lt;dbl&gt;, ats7_max &lt;dbl&gt;,
## #   ats8_max &lt;dbl&gt;, ats9_max &lt;dbl&gt;, ats10_max &lt;dbl&gt;,
## #   ats11_max &lt;dbl&gt;, ats12_max &lt;dbl&gt;, ats13_max &lt;dbl&gt;,
## #   ats14_max &lt;dbl&gt;, ats15_max &lt;dbl&gt;, ats16_max &lt;dbl&gt;,
## #   ats17_max &lt;dbl&gt;, ats18_max &lt;dbl&gt;, ats19_max &lt;dbl&gt;,
## #   ats20_max &lt;dbl&gt;, ats21_max &lt;dbl&gt;, ats22_max &lt;dbl&gt;,
## #   ats23_max &lt;dbl&gt;, ats24_max &lt;dbl&gt;, ats25_max &lt;dbl&gt;,
## #   ats26_max &lt;dbl&gt;, ats27_max &lt;dbl&gt;, ats28_max &lt;dbl&gt;,
## #   ats29_max &lt;dbl&gt;, ats2_re_max &lt;dbl&gt;, ats4_re_max &lt;dbl&gt;,
## #   ats6_re_max &lt;dbl&gt;, ats7_re_max &lt;dbl&gt;,
## #   ats10_re_max &lt;dbl&gt;, ats12_re_max &lt;dbl&gt;,
## #   ats14_re_max &lt;dbl&gt;, ats15_re_max &lt;dbl&gt;,
## #   ats16_re_max &lt;dbl&gt;, ats18_re_max &lt;dbl&gt;,
## #   ats20_re_max &lt;dbl&gt;, ats25_re_max &lt;dbl&gt;,
## #   ats27_re_max &lt;dbl&gt;, ats28_re_max &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1">attitudeDataNoNA <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise_at</span>(</a>
<a class="sourceLine" id="cb108-3" data-line-number="3">    <span class="kw">vars</span>(Year),</a>
<a class="sourceLine" id="cb108-4" data-line-number="4">    <span class="kw">funs</span>(min, max)</a>
<a class="sourceLine" id="cb108-5" data-line-number="5">  )</a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##     min   max
##   &lt;dbl&gt; &lt;dbl&gt;
## 1     1     4</code></pre>
</div>
<div id="different-data-formats" class="section level4">
<h4><span class="header-section-number">2.7.1.3</span> Different data formats</h4>
<p>Sometimes we need to reformat our data in order to analyze it or visualize it in a specific way. Two tidyverse functions, <code>gather()</code> and <code>spread()</code>, help us to do this.</p>
<p>For example, say we want to examine the distribution of the raw responses to each of the ATS items (i.e., a histogram). In this case, we would need our x-axis to be a single column of the responses across all the ATS items. However, currently the responses for each item are stored in 29 different columns.</p>
<p>This means that we need to create a new version of this dataset. It will have four columns:
- ID
- Year
- Question (for each of the ATS items)
- ResponseRaw (for the raw response to each of the ATS items)</p>
<p>Thus, we want change the format of the dataset from being “wide” to being “long”.</p>
<p>We change the format to “wide” using the <code>gather()</code> function.</p>
<p><code>gather()</code> takes a number of variables and reformates them into two variables: one that contains the variable values, and another called the “key” that tells us which variable the value came from. In this case, we want it to reformat the data so that each response to an ATS question is in a separate row and the key column tells us which ATS question it corresponds to. It is much better to see this in practice than to explain in words!</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">attitudeData_long &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb110-2" data-line-number="2"><span class="st">  </span>attitudeDataNoNA <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-3" data-line-number="3"><span class="st">  </span><span class="co">#remove the raw variables that you recoded</span></a>
<a class="sourceLine" id="cb110-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ats_recode) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-5" data-line-number="5"><span class="st">  </span><span class="kw">gather</span>(</a>
<a class="sourceLine" id="cb110-6" data-line-number="6">    <span class="co"># key refers to the new variable containing the question number</span></a>
<a class="sourceLine" id="cb110-7" data-line-number="7">    <span class="dt">key =</span> question,</a>
<a class="sourceLine" id="cb110-8" data-line-number="8">    <span class="co"># value refers to the new response variable</span></a>
<a class="sourceLine" id="cb110-9" data-line-number="9">    <span class="dt">value =</span> response, </a>
<a class="sourceLine" id="cb110-10" data-line-number="10">    <span class="co">#the only variables we DON&#39;T want to gather</span></a>
<a class="sourceLine" id="cb110-11" data-line-number="11">    <span class="op">-</span>ID, <span class="op">-</span>Year, <span class="op">-</span>StatsBefore </a>
<a class="sourceLine" id="cb110-12" data-line-number="12">  )</a>
<a class="sourceLine" id="cb110-13" data-line-number="13"></a>
<a class="sourceLine" id="cb110-14" data-line-number="14">attitudeData_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-15" data-line-number="15"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)</a></code></pre></div>
<pre><code>## # A tibble: 20 x 5
##    ID     Year StatsBefore question response
##    &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;
##  1 1         3 Yes         ats1            6
##  2 2         4 No          ats1            4
##  3 3         2 No          ats1            6
##  4 4         1 Yes         ats1            3
##  5 5         2 No          ats1            7
##  6 6         3 No          ats1            4
##  7 7         4 Yes         ats1            6
##  8 8         2 Yes         ats1            5
##  9 9         2 Yes         ats1            7
## 10 10        2 Yes         ats1            5
## 11 11        4 No          ats1            5
## 12 12        2 No          ats1            4
## 13 13        3 Yes         ats1            2
## 14 14        1 Yes         ats1            6
## 15 15        2 No          ats1            7
## 16 16        4 No          ats1            7
## 17 17        2 No          ats1            7
## 18 18        2 No          ats1            6
## 19 19        1 No          ats1            6
## 20 20        1 No          ats1            3</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="kw">glimpse</span>(attitudeData_long)</a></code></pre></div>
<pre><code>## Observations: 4,089
## Variables: 5
## $ ID          &lt;chr&gt; &quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8…
## $ Year        &lt;dbl&gt; 3, 4, 2, 1, 2, 3, 4, 2, 2, 2, 4, 2, 3…
## $ StatsBefore &lt;chr&gt; &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;No&quot;,…
## $ question    &lt;chr&gt; &quot;ats1&quot;, &quot;ats1&quot;, &quot;ats1&quot;, &quot;ats1&quot;, &quot;ats1…
## $ response    &lt;dbl&gt; 6, 4, 6, 3, 7, 4, 6, 5, 7, 5, 5, 4, 2…</code></pre>
<p>Say we now wanted to undo the <code>gather()</code> and return our dataset to wide format. For this, we would use the function <code>spread()</code>.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1">attitudeData_wide &lt;-</a>
<a class="sourceLine" id="cb114-2" data-line-number="2"><span class="st">  </span>attitudeData_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb114-3" data-line-number="3"><span class="st">  </span><span class="kw">spread</span>(</a>
<a class="sourceLine" id="cb114-4" data-line-number="4">    <span class="co">#key refers to the variable indicating which question </span></a>
<a class="sourceLine" id="cb114-5" data-line-number="5">    <span class="co"># each response belongs to</span></a>
<a class="sourceLine" id="cb114-6" data-line-number="6">    <span class="dt">key =</span> question, </a>
<a class="sourceLine" id="cb114-7" data-line-number="7">    <span class="dt">value =</span> response</a>
<a class="sourceLine" id="cb114-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb114-9" data-line-number="9"></a>
<a class="sourceLine" id="cb114-10" data-line-number="10">attitudeData_wide <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb114-11" data-line-number="11"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>)</a></code></pre></div>
<pre><code>## # A tibble: 20 x 32
##    ID     Year StatsBefore  ats1 ats10_re ats11 ats12_re
##    &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1 1         3 Yes             6        6     6        6
##  2 10        2 Yes             5        5     3        4
##  3 100       4 Yes             5        6     4        2
##  4 101       2 No              4        7     2        4
##  5 102       3 Yes             5        6     5        6
##  6 103       2 No              6        7     5        7
##  7 104       2 Yes             6        5     5        3
##  8 105       3 No              6        6     5        6
##  9 106       1 No              4        4     4        4
## 10 107       2 No              1        2     1        1
## 11 108       2 No              7        7     7        7
## 12 109       2 No              4        4     4        6
## 13 11        4 No              5        5     3        4
## 14 110       3 No              5        7     4        4
## 15 111       2 No              6        6     6        3
## 16 112       3 No              6        7     5        7
## 17 114       2 No              5        4     4        3
## 18 115       3 No              5        7     5        1
## 19 116       3 No              5        6     5        5
## 20 118       2 No              6        6     6        1
## # … with 25 more variables: ats13 &lt;dbl&gt;, ats14_re &lt;dbl&gt;,
## #   ats15_re &lt;dbl&gt;, ats16_re &lt;dbl&gt;, ats17 &lt;dbl&gt;,
## #   ats18_re &lt;dbl&gt;, ats19 &lt;dbl&gt;, ats2_re &lt;dbl&gt;,
## #   ats20_re &lt;dbl&gt;, ats21 &lt;dbl&gt;, ats22 &lt;dbl&gt;, ats23 &lt;dbl&gt;,
## #   ats24 &lt;dbl&gt;, ats25_re &lt;dbl&gt;, ats26 &lt;dbl&gt;,
## #   ats27_re &lt;dbl&gt;, ats28_re &lt;dbl&gt;, ats29 &lt;dbl&gt;,
## #   ats3 &lt;dbl&gt;, ats4_re &lt;dbl&gt;, ats5 &lt;dbl&gt;, ats6_re &lt;dbl&gt;,
## #   ats7_re &lt;dbl&gt;, ats8 &lt;dbl&gt;, ats9 &lt;dbl&gt;</code></pre>
<p>Now that we have created a “long” version of our data, they are in the right format to create the plot. We will use the tidyverse function <code>ggplot()</code> to create our histogram with <code>geom_histogram</code>.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1">attitudeData_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb116-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> response)) <span class="op">+</span></a>
<a class="sourceLine" id="cb116-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb116-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq.int</span>(<span class="dv">1</span>, <span class="dv">7</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="StatsThinking21_files/figure-html/unnamed-chunk-43-1.png" width="576" /></p>
<p>It looks like responses were fairly positively overall.</p>
<p>We can also aggregate each participant’s responses to each question during each year of their study at Stanford to examine the distribution of mean ATS responses across people by year.</p>
<p>We will use the <code>group_by()</code> and <code>summarize()</code> functions to aggregate the responses.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1">attitudeData_agg &lt;-</a>
<a class="sourceLine" id="cb117-2" data-line-number="2"><span class="st">  </span>attitudeData_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb117-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(ID, Year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb117-4" data-line-number="4"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb117-5" data-line-number="5">    <span class="dt">mean_response =</span> <span class="kw">mean</span>(response)</a>
<a class="sourceLine" id="cb117-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb117-7" data-line-number="7">attitudeData_agg</a></code></pre></div>
<pre><code>## # A tibble: 141 x 3
## # Groups:   ID [141]
##    ID     Year mean_response
##    &lt;chr&gt; &lt;dbl&gt;         &lt;dbl&gt;
##  1 1         3          6   
##  2 10        2          4.66
##  3 100       4          5.03
##  4 101       2          5.10
##  5 102       3          4.66
##  6 103       2          5.55
##  7 104       2          4.31
##  8 105       3          5.10
##  9 106       1          4.21
## 10 107       2          2.45
## # … with 131 more rows</code></pre>
<p>First let’s use the geom_density argument in <code>ggplot()</code> to look at mean responses across people, ignoring year of response. The density argrument is like a histogram but smooths things over a bit.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1">attitudeData_agg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb119-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(mean_response)) <span class="op">+</span></a>
<a class="sourceLine" id="cb119-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_density</span>()</a></code></pre></div>
<p><img src="StatsThinking21_files/figure-html/unnamed-chunk-45-1.png" width="576" /></p>
<p>Now we can also look at the distribution for each year.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1">attitudeData_agg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(mean_response, <span class="dt">color =</span> <span class="kw">factor</span>(Year))) <span class="op">+</span></a>
<a class="sourceLine" id="cb120-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_density</span>()</a></code></pre></div>
<p><img src="StatsThinking21_files/figure-html/unnamed-chunk-46-1.png" width="576" /></p>
<p>Or look at trends in responses across years.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1">attitudeData_agg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(Year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb121-4" data-line-number="4">    <span class="dt">mean_response =</span> <span class="kw">mean</span>(mean_response)</a>
<a class="sourceLine" id="cb121-5" data-line-number="5">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Year, mean_response)) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="StatsThinking21_files/figure-html/unnamed-chunk-47-1.png" width="576" /></p>
<p>This looks like a precipitous drop - but how might that be misleading?</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-visualization-using-r-with-anna-khazenzon.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="book_assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="book_assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="book_assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="book_assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/poldrack/psych10-book/edit/master/02-SummarizingData.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["StatsThinking21.pdf", "StatsThinking21.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
